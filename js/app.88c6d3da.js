(function(t){function e(e){for(var a,o,r=e[0],l=e[1],c=e[2],u=0,m=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&m.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(m.length)m.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],a=!0,r=1;r<i.length;r++){var l=i[r];0!==s[l]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=i[0]))}return t}var a={},s={app:0},n=[];function o(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=a,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(i,a,function(e){return t[e]}.bind(null,a));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0190":function(t,e,i){},"032d":function(t,e,i){"use strict";i("05a9")},"0494":function(t,e,i){"use strict";i("d469")},"05a9":function(t,e,i){},"0efd":function(t,e,i){"use strict";i("7b30")},1722:function(t,e,i){"use strict";i("ff96")},"19d5":function(t,e,i){},"2b84":function(t,e,i){t.exports=i.p+"img/user.ecba1844.gif"},"39bf":function(t,e,i){},4223:function(t,e,i){"use strict";i("d716")},"4c3c":function(t,e,i){"use strict";i("19d5")},"4de5":function(t,e,i){"use strict";i("db41")},"52a7":function(t,e,i){"use strict";i("e636")},"555f":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("6fa9"),i("97f4"),i("b0c7"),i("311b"),i("5a65"),i("92ca"),i("5f9d"),i("5685");var a=i("430a"),s=i("a5e4"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("router-view")},o=[],r={},l=r,c=i("cba8"),d=Object(c["a"])(l,n,o,!1,null,null,null),u=d.exports,m=(i("606e"),i("2c2d"),i("7736"));a["default"].use(m["a"]);var f=new m["a"].Store({state:{token:localStorage.getItem("token")?localStorage.getItem("token"):"",routerParams:localStorage.getItem("routerParams")?JSON.parse(localStorage.getItem("routerParams")):{},currentPage:localStorage.getItem("currentPage")?localStorage.getItem("currentPage"):1},mutations:{setToken:function(t,e){window.localStorage.setItem("token",e),t.token=e},setRouterParams:function(t,e){t.routerParams[e.name]=e.params,window.localStorage.setItem("routerParams",JSON.stringify(t.routerParams))},setCurrentPage:function(t,e){window.localStorage.setItem("currentPage",e),t.currentPage=e}},actions:{},modules:{}}),p=i("8975"),g=i.n(p),v=(i("a342"),i("c2b1"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper",class:{"nav-open":t.$sidebar.showSidebar}},[i("side-bar",{attrs:{"sidebar-item-color":t.sidebarBackground,"sidebar-background-image":t.sidebarBackgroundImage,"sidebar-background-color":t.sidebarBackgroundColor}},[i("mobile-menu",{attrs:{slot:"content"},slot:"content"}),i("sidebar-link",{attrs:{to:"/services"}},[i("i",{staticClass:"iconfont icon-fuwuqi"}),i("p",[t._v("服务管理")])]),i("sidebar-link",{attrs:{to:"/router"}},[i("i",{staticClass:"iconfont icon-lianjie"}),i("p",[t._v("路由管理")])]),i("sidebar-link",{attrs:{to:"/certificate"}},[i("i",{staticClass:"iconfont icon-zhengshu-copy"}),i("p",[t._v("证书管理")])])],1),i("div",{staticClass:"main-panel"},[i("top-navbar"),i("dashboard-content")],1),i("notifications"),i("dialog")],1)}),h=[],_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("md-toolbar",{staticClass:"md-transparent",attrs:{"md-elevation":"0"}},[a("div",{staticClass:"md-toolbar-row"},[a("div",{staticClass:"md-toolbar-section-end"},[a("md-button",{staticClass:"md-just-icon md-simple md-toolbar-toggle",class:{toggled:t.$sidebar.showSidebar},on:{click:t.toggleSidebar}},[a("span",{staticClass:"icon-bar"}),a("span",{staticClass:"icon-bar"}),a("span",{staticClass:"icon-bar"})]),a("div",{staticClass:"md-collapse"},[a("md-list",[a("li",{staticClass:"md-list-item"},[a("a",{staticClass:"\n                  md-list-item-router md-list-item-container md-button-clean\n                  dropdown\n                ",attrs:{href:"javascript:void(0);"}},[a("div",{staticClass:"md-list-item-content"},[a("drop-down",[a("md-button",{staticClass:"md-button md-just-icon md-simple",attrs:{slot:"title","data-toggle":"dropdown"},slot:"title"},[a("img",{staticStyle:{height:"40px",width:"40px","border-radius":"20px"},attrs:{src:i("2b84")}})]),a("ul",{staticClass:"dropdown-menu dropdown-menu-right"},[a("li",[a("a",{attrs:{href:"#"},on:{click:t.logout}},[t._v("退出")])])])],1)],1)])])])],1)],1)])])},b=[],y=i("9035"),C=i.n(y);C.a.defaults.timeout=15e3,C.a.interceptors.request.use((function(t){return t}),(function(t){return Promise.reject(t)})),C.a.interceptors.response.use((function(t){var e=t.data;return 401===e.code&&(window.location.href="/#/login"),401===e.code?(message.error("登录状态失效"),window.location.href="/#/login"):403===e.code&&(message.error(e.msg),window.location.href="/#/choose"),t}),(function(t){return Promise.reject(t)}));var w=C.a;function k(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"get",a={"auth-token":f.state.token};switch(i){case"delete":return x(t,e,a);case"post":return $(t,e,a);case"put":return P(t,e,a);default:return S(t,e,a)}}function $(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i["Content-Type"]="application/json",e=JSON.stringify(e),new Promise((function(a,s){w.post(t,e,{headers:i}).then((function(t){a(t.data)}),(function(t){s(t)}))}))}function P(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i["Content-Type"]="application/json",e=JSON.stringify(e),new Promise((function(a,s){w.put(t,e,{headers:i}).then((function(t){a(t.data)}),(function(t){s(t)}))}))}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(a,s){w.get(t,{params:e,headers:i}).then((function(t){a(t.data)})).catch((function(t){s(t)}))}))}function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(a,s){w.delete(t,{params:e,headers:i}).then((function(t){a(t.data)})).catch((function(t){s(t)}))}))}var I={login:function(t,e){return k("admin/user/login",{email:t,password:e},"post")},logout:function(t,e){return k("admin/user/logout",null,"post")},register:function(t){return k("admin/user/register",t,"post")}},L={data:function(){return{selectedEmployee:null}},methods:{toggleSidebar:function(){this.$sidebar.displaySidebar(!this.$sidebar.showSidebar)},logout:function(){var t=this;I.logout().then((function(e){0===e.code?(t.$store.commit("setToken",""),t.$router.push({name:"Login"})):t.$notify({message:e.msg})}))}}},T=L,R=Object(c["a"])(T,_,b,!1,null,null,null),N=R.exports,O=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade",mode:"out-in"}},[i("router-view")],1)},D=[],j={},E=j,q=(i("032d"),Object(c["a"])(E,O,D,!1,null,"089ffd8e",null)),z=q.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"nav nav-mobile-menu"},[i("li",[i("a",{staticClass:"dropdown-toggle",attrs:{href:"#","data-toggle":"dropdown"}},[i("i",{staticClass:"material-icons"},[t._v("person")]),i("p",{on:{click:t.logout}},[t._v("退出")])])])])},H=[],M={methods:{toggleSidebar:function(){this.$sidebar.displaySidebar(!this.$sidebar.showSidebar)},logout:function(){var t=this;I.logout().then((function(e){0===e.code?(t.$store.commit("setToken",""),t.$router.push({name:"Login"})):t.$notify({message:e.msg})}))}}},B=M,V=Object(c["a"])(B,A,H,!1,null,null,null),J=V.exports,F={components:{TopNavbar:N,DashboardContent:z,MobileMenu:J},data:function(){return{sidebarBackground:"blue",sidebarBackgroundImage:i("9524"),sidebarBackgroundColor:"#002140"}}},U=F,K=(i("5985"),Object(c["a"])(U,v,h,!1,null,"bc71d9a8",null)),G=K.exports,X=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("div",{staticClass:"md-layout"},[i("div",{staticClass:"md-layout-item md-medium-size-100 md-xsmall-size-100 md-size-100"},[i("md-card",[i("list-header",{attrs:{"sidebar-item-color":t.sidebarBackground,icon:"icon-fuwuqi",title:"服务管理",title_href:"Services"}}),i("md-card-content",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("协议类型")]),i("md-select",{attrs:{name:"protocol",id:"protocol","md-dense":""},model:{value:t.serviceParams.protocol,callback:function(e){t.$set(t.serviceParams,"protocol",e)},expression:"serviceParams.protocol"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("HTTP")]),i("md-option",{attrs:{value:"2"}},[t._v("HTTPS")]),i("md-option",{attrs:{value:"3"}},[t._v("HTTP&HTTPS")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("启用状态")]),i("md-select",{attrs:{name:"enable",id:"enable","md-dense":""},model:{value:t.serviceParams.enable,callback:function(e){t.$set(t.serviceParams,"enable",e)},expression:"serviceParams.enable"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("启用")]),i("md-option",{attrs:{value:"2"}},[t._v("停用")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("发布状态")]),i("md-select",{attrs:{name:"release",id:"release","md-dense":""},model:{value:t.serviceParams.release,callback:function(e){t.$set(t.serviceParams,"release",e)},expression:"serviceParams.release"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("未发布")]),i("md-option",{attrs:{value:"2"}},[t._v("待发布")]),i("md-option",{attrs:{value:"3"}},[t._v("已发布")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("搜索内容")]),i("md-input",{attrs:{type:"text"},model:{value:t.serviceParams.search,callback:function(e){t.$set(t.serviceParams,"search",e)},expression:"serviceParams.search"}})],1)],1),i("div",{staticClass:"md-layout-item text-right"},[i("md-button",{staticClass:"md-raised md-primary addNode",on:{click:function(e){return t.drawerService("")}}},[i("i",{staticClass:"iconfont icon-addNode"}),t._v(" 新增服务 ")])],1)])])],1),i("md-card",[i("md-card-content",[i("md-table",[i("md-table-row",{staticClass:"md-head"},[i("md-table-head",[t._v("ID/名称")]),i("md-table-head",[t._v("域名")]),i("md-table-head",[t._v("协议")]),i("md-table-head",[t._v("插件")]),i("md-table-head",[t._v(" 发布 "),i("i",{staticClass:"iconfont icon-help color-orange"},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(" 未发布：新增但未发布到数据面"),i("br"),t._v(" 待发布：当前配置与数据面不符"),i("br"),t._v(" 已发布：当前配置已发布数据面 ")])],1)]),i("md-table-head",[t._v("启用")]),i("md-table-head",[t._v("操作")])],1),t._l(t.serviceList,(function(e,a){return i("md-table-row",{key:a},[i("md-table-cell",[i("span",{staticClass:"font-link-color",on:{click:function(i){return t.drawerService(e)}}},[t._v(" "+t._s(e.res_id)+" ")]),i("br"),e.edit_name?i("md-field",{staticClass:"field-edit-name"},[i("md-input",{on:{blur:function(i){return t.saveServiceName(e)}},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"item.name"}})],1):i("span",[t._v(" "+t._s(e.name)+" "),i("i",{staticClass:"iconfont icon-xiugai",on:{click:function(i){return t.editServiceName(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("修改名称")])],1)])],1),i("md-table-cell",[i("div",{staticStyle:{cursor:"pointer"}},[t._v(" "+t._s(e.service_domains[0])),Object.keys(e.service_domains).length>1?i("span",[t._v(" ......")]):t._e(),i("md-tooltip",{attrs:{"md-direction":"top"}},t._l(e.service_domains,(function(e,a){return i("div",{key:a},[t._v(" "+t._s(e)+" ")])})),0)],1)]),i("md-table-cell",[1===e.protocol?i("span",{staticClass:"color-blue"},[t._v(t._s(t._f("protocolName")(e.protocol)))]):t._e(),2===e.protocol?i("span",{staticClass:"color-orange"},[t._v(t._s(t._f("protocolName")(e.protocol)))]):t._e(),3===e.protocol?i("span",{staticClass:"color-purple"},[t._v(t._s(t._f("protocolName")(e.protocol)))]):t._e()]),i("md-table-cell",t._l(e.plugin_list,(function(e,a){return i("i",{key:a,staticClass:"iconfont",class:[e.icon,e.color],staticStyle:{margin:"3px"}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(t._s(e.name))])],1)})),0),i("md-table-cell",[1===e.release?i("span",{staticClass:"color-grey font-bold"},[t._v("未发布")]):t._e(),2===e.release?i("span",{staticClass:"color-orange font-bold"},[t._v("待发布")]):t._e(),3===e.release?i("span",{staticClass:"color-green font-bold"},[t._v("已发布")]):t._e()]),i("md-table-cell",[i("md-switch",{staticClass:"md-primary",on:{change:function(i){return t.putSwitchEnable(e)}},model:{value:e.enable,callback:function(i){t.$set(e,"enable",i)},expression:"item.enable"}})],1),i("md-table-cell",{staticClass:"list_manage"},[3!==e.release?i("i",{staticClass:"iconfont icon-yuntongbu",on:{click:function(i){return t.putSwitchRelease(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("发布")])],1):t._e(),i("a",{attrs:{href:"javascript:void(0);"},on:{click:function(i){return t.drawerPlugin(e)}}},[i("i",{staticClass:"iconfont icon-chajiangongneng"},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("插件")])],1)]),i("router-link",{attrs:{to:{name:"Router",params:{service_res_id:e.res_id}}}},[i("i",{staticClass:"iconfont icon-lianjie"},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("路由")])],1)]),i("i",{staticClass:"iconfont icon-xiugai",on:{click:function(i){return t.drawerService(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("修改")])],1),i("i",{staticClass:"iconfont icon-shanchu",on:{click:function(i){return t.deleteService(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("删除")])],1)],1)],1)}))],2),t.total>0?i("Pager",{attrs:{pageSize:t.page_size,"current-pages":t.currentPage,totals:t.total,tab:t.isTab},on:{"current-change":t.handleCurrentChange}}):t._e()],1)],1)],1)]),i("Drawer",{attrs:{title:t.currentServiceResId?"编辑服务":"新增服务",width:"700px",display:t.drawerDisplay,inner:!0},on:{"update:display":function(e){t.drawerDisplay=e}}},[t.isShow?i("ServiceModify",{attrs:{serviceResId:t.currentServiceResId},on:{closeDrawer:t.closeDrawer,saveHandle:t.saveHandle}}):t._e()],1),i("Drawer",{attrs:{title:"插件列表",display:t.drawerPluginDisplay,inner:!0,width:"960px"},on:{"update:display":function(e){t.drawerPluginDisplay=e}}},[t.isPluginShow?i("PluginList",{attrs:{targetResId:t.pluginServiceResId,pluginConfigType:t.pluginConfigType},on:{refreshList:t.refreshList}}):t._e()],1)],1)},Y=[],Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-wrapper clearfix"},[i("div",{staticClass:"page-info fl"},[i("span",{staticClass:"item-count h50"},[t._v(" 总共 "),i("span",[t._v(t._s(t.totals))]),t._v("条， ")]),i("span",{staticClass:"h50"},[i("span",[t._v(t._s(t.totalPages))]),t._v("页 ")])]),i("div",{staticClass:"page-tab fl clearfix"},[i("button",{staticClass:"fl h50 cursor",class:{canNot:1==t.currentPage},attrs:{disabled:t.preDisabled},on:{click:t.firstPage}},[t._v(" 首页 ")]),i("button",{staticClass:"fl h50 cursor",class:{canNot:1==t.currentPage},attrs:{disabled:t.preDisabled},on:{click:t.prePage}},[t._v(" 上一页 ")]),i("ul",{staticClass:"fl"},t._l(t.itemArr,(function(e,a){return i("li",{key:a,staticClass:"cursor",class:{activePage:t.currentPage===e},on:{click:function(i){return t.changePage(e)}}},[t._v(" "+t._s(e)+" ")])})),0),i("button",{staticClass:"fl h50 cursor",class:{canNot:t.currentPage==t.totalPages},attrs:{disabled:t.nextDisabled},on:{click:t.nextPage}},[t._v(" 下一页 ")]),i("button",{staticClass:"fl h50 cursor",class:{canNot:t.currentPage==t.totalPages},attrs:{disabled:t.nextDisabled},on:{click:t.lastPage}},[t._v(" 尾页 ")])])])},W=[],Z=(i("3267"),{name:"Pager",props:{pageSize:{default:10,type:Number},currentPages:{default:1,type:Number},totals:{default:0,type:Number},tab:{type:Boolean,default:!1},pageSizeSettings:{type:Array,default:function(){return[10,20,50,100]}}},data:function(){return{itemsShow:!1,itemArr:[],nextDisabled:null,preDisabled:"disabled",totalPages:1,currentPage:this.currentPages,size:this.pageSize}},computed:{pageNum:function(){var t=this.pageSize;return t},pageItems:function(){var t=this.totals;return t}},created:function(){this.pages()},methods:{chooseNum:function(t){this.itemsShow=!1,this.$emit("size-change",{pageSize:t})},handleChooseNumClick:function(){this.itemsShow=!this.itemsShow},blur:function(){var t=this;setTimeout((function(){t.itemsShow=!1}),200)},changePage:function(t){this.currentPage=t,this.pages()},nextPage:function(){this.currentPage<=this.totalPages-1&&this.currentPage++},prePage:function(){this.currentPage>1&&this.currentPage--},firstPage:function(){this.currentPage=1},lastPage:function(){this.currentPage=this.totalPages},pages:function(){this.itemArr=[],this.totalPages=Math.ceil(this.pageItems/this.pageNum),this.preDisabled=1===this.currentPage?"disabled":null,this.nextDisabled=this.currentPage===this.totalPages?"disabled":null;var t=this.currentPage-2>1?this.currentPage-2:1,e=this.currentPage>3?this.totalPages-this.currentPage>=2?this.currentPage+2:this.totalPages:5;t=this.totalPages-this.currentPage>=2?t:e-4,this.totalPages<=5&&(t=1,e=this.totalPages);for(var i=t;i<=e;i++)this.itemArr.push(i)}},watch:{pageNum:function(){this.currentPage=1,this.pages(),this.$emit("size-change",{pageSize:this.pageNum})},currentPage:function(){this.pages(),this.$emit("current-change",{pageSize:this.pageNum,currentPage:this.currentPage})},totals:function(){this.pages()},tab:function(){this.currentPage=1}}}),tt=Z,et=(i("4c3c"),Object(c["a"])(tt,Q,W,!1,null,"6011a2cd",null)),it=et.exports,at=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"list-header"},[i("div",{staticClass:"list-header-icon",attrs:{"data-color":t.sidebarItemColor}},[i("i",{staticClass:"iconfont",class:t.icon})]),i("div",{staticClass:"list-header-title"},[i("router-link",{attrs:{to:{name:t.title_href}}},[t._v(t._s(t.title)+" "),i("span",{staticClass:"subtitle"},[t._v(t._s(t.subtitle))])])],1)])},st=[],nt={name:"ListHeader",props:{sidebarItemColor:{type:String,default:"blue",validator:function(t){var e=["blue","green","orange","red","purple"];return-1!==e.indexOf(t)}},title:{type:String,default:""},subtitle:{type:String,default:""},title_href:{type:String,default:""},icon:{type:String,default:""}}},ot=nt,rt=(i("89b6"),Object(c["a"])(ot,at,st,!1,null,"079c5beb",null)),lt=rt.exports,ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("form",[i("div",[i("md-field",[i("label",[t._v("服务名称")]),i("md-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),Object.keys(t.form.service_domains).length>0?i("div",t._l(t.$v.form.service_domains.$each.$iter,(function(e,a){return i("div",{key:a,staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",{class:t.getValidationClass("service_domains")},[i("label",[t._v("域名")]),i("md-input",{attrs:{required:""},model:{value:t.form.service_domains[a],callback:function(e){t.$set(t.form.service_domains,a,"string"===typeof e?e.trim():e)},expression:"form.service_domains[index]"}}),i("i",{staticClass:"iconfont icon-tianjia",on:{click:t.addDomain}}),0!=a?i("i",{staticClass:"iconfont icon-jian",on:{click:function(e){return t.removeDomain(a)}}}):t._e(),e.required?t._e():i("span",{staticClass:"md-error"},[t._v("域名不能为空")])],1)],1)])})),0):t._e(),i("div",{staticClass:"service-advanced"},[i("div",{staticClass:"form-item"},[i("label",{staticClass:"form-label"},[t._v("请求协议：")]),i("md-radio",{attrs:{value:"1"},model:{value:t.form.protocol,callback:function(e){t.$set(t.form,"protocol",e)},expression:"form.protocol"}},[t._v("HTTP")]),i("md-radio",{attrs:{value:"2"},model:{value:t.form.protocol,callback:function(e){t.$set(t.form,"protocol",e)},expression:"form.protocol"}},[t._v("HTTPS")]),i("md-radio",{attrs:{value:"3"},model:{value:t.form.protocol,callback:function(e){t.$set(t.form,"protocol",e)},expression:"form.protocol"}},[t._v("HTTP&HTTPS")])],1),i("div",{staticClass:"form-item"},[i("label",{staticClass:"form-label"},[t._v("启用：")]),i("md-switch",{staticClass:"md-primary",model:{value:t.form.enable,callback:function(e){t.$set(t.form,"enable",e)},expression:"form.enable"}})],1)]),i("div",{staticClass:"service-button"},[i("md-button",{staticClass:"md-raised",on:{click:function(e){return t.$emit("closeDrawer")}}},[t._v("取消")]),i("md-button",{staticClass:"md-raised md-primary",on:{click:t.submitForm}},[t._v("保存")])],1)])])},dt=[],ut=(i("d702"),{getNameList:function(){return k("admin/service/name/list",null)},getList:function(t){return k("admin/service/list",t)},info:function(t){return k("admin/service/info/"+t)},post:function(t){return k("admin/service/add",t,"post")},put:function(t,e){return k("admin/service/update/"+t,e,"put")},putName:function(t,e){return k("admin/service/update/name/"+t,{name:e},"put")},putSwitchRelease:function(t){return k("admin/service/switch/release/"+t,null,"put")},putSwitchEnable:function(t,e){return k("admin/service/switch/enable/"+t,{enable:e},"put")},delete:function(t){return k("admin/service/delete/"+t,null,"delete")}}),mt=i("afd0"),ft={name:"ServiceModify",props:{serviceResId:{type:String,default:""}},data:function(){return{form:{name:"",service_domains:[],protocol:"1",enable:2}}},validations:{form:{service_domains:{$each:{required:mt["required"]}},protocol:{required:mt["required"]}}},mounted:function(){this.getInfo()},methods:{getValidationClass:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=e?this.$v.form[e][t]:this.$v.form[t];if(i)return{"md-invalid":i.$invalid&&i.$dirty}},getInfo:function(){var t=this;this.form.service_domains=[""],0!==this.serviceResId.length&&ut.info(this.serviceResId).then((function(e){if(0!==e.code)return t.$notify({message:e.msg}),t.$emit("saveHandle");for(var i=e.data,a=0,s=Object.keys(t.form);a<s.length;a++){var n=s[a];t.form[n]=i[n]}t.form.protocol=t.form.protocol.toString(),t.form.enable=1==t.form.enable,0===t.form.service_domains.length&&(t.form.service_domains=[""])}))},submitForm:function(){var t=this;if(this.$v.$touch(),!this.$v.$invalid){var e,i=JSON.parse(JSON.stringify(this.form));i.protocol=parseInt(i.protocol),i.enable=!0===i.enable?1:2,e=this.serviceResId?ut.put(this.serviceResId,i):ut.post(i),e.then((function(e){if(0===e.code)return t.$notify({message:e.msg,type:"primary"}),t.$emit("saveHandle");t.$notify({message:e.msg})}))}},addDomain:function(){this.form.service_domains.push("")},removeDomain:function(t){this.$delete(this.form.service_domains,t)}}},pt=ft,gt=(i("813d"),Object(c["a"])(pt,ct,dt,!1,null,"7c9008c2",null)),vt=gt.exports,ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"drawer"},[i("div",{class:t.maskClass,on:{click:t.closeByMask}}),i("div",{staticClass:"main md-scrollbar",class:t.mainClass,style:t.mainStyle},[i("div",{staticClass:"drawer-head"},[i("span",[t._v(t._s(t.title))]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.closable,expression:"closable"}],staticClass:"close-btn",on:{click:t.closeByButton}},[t._v("X")])]),i("div",{staticClass:"drawer-body"},[t._t("default")],2)])])},_t=[],bt={props:{display:{type:Boolean},title:{type:String,default:"标题"},closable:{type:Boolean,default:!0},mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},width:{type:String,default:"700px"},inner:{type:Boolean,default:!1}},computed:{maskClass:function(){return{"mask-show":this.mask&&this.display,"mask-hide":!(this.mask&&this.display),inner:this.inner}},mainClass:function(){return{"main-show":this.display,"main-hide":!this.display,inner:this.inner}},mainStyle:function(){return{width:this.width,right:this.display?"0":"-".concat(this.width),borderLeft:this.mask?"none":"1px solid #eee"}}},mounted:function(){if(this.inner){var t=this.$el.parentNode;t.style.position="relative"}},methods:{closeByMask:function(){this.maskClosable&&this.$emit("update:display",!1)&&this.$emit("refreshList")},closeByButton:function(){this.$emit("update:display",!1)&&this.$emit("refreshList")}}},yt=bt,Ct=(i("9881"),Object(c["a"])(yt,ht,_t,!1,null,"76061a56",null)),wt=Ct.exports,kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"plugin-button"},[i("md-button",{staticClass:"md-raised md-primary addNode",on:{click:t.addPluginForm}},[i("i",{staticClass:"iconfont icon-addNode"}),t._v(" 新增插件")])],1),i("md-card",{directives:[{name:"show",rawName:"v-show",value:t.addPlugin,expression:"addPlugin"}],staticClass:"plug-card"},[i("div",{staticClass:"plug_tab"},[i("span",{class:{tab_active:t.plugAddInfo},on:{click:function(e){return t.plugTab("plugAddInfo")}}},[t._v("插件信息")]),i("span",{class:{tab_active:t.plugAddSetting},on:{click:function(e){return t.plugTab("plugAddSetting")}}},[t._v("插件配置")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.plugAddInfo,expression:"plugAddInfo"}]},[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("选择插件")]),i("md-select",{attrs:{name:"plugin_id",id:"plugin_id","md-dense":""},on:{"md-selected":t.pluginChange},model:{value:t.form.plugin_id,callback:function(e){t.$set(t.form,"plugin_id",e)},expression:"form.plugin_id"}},t._l(t.pluginSettingList,(function(e,a){return i("md-option",{key:a,attrs:{value:e.res_id}},[t._v(t._s(e.plugin_key))])})),1)],1)],1)]),t.plugInInfo&&Object.keys(t.pluginTypeList).length>0?i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("插件类型")]),i("md-select",{attrs:{name:"plugin_type",id:"plugin_type",disabled:"","md-dense":""},model:{value:t.plugInInfo.type,callback:function(e){t.$set(t.plugInInfo,"type",e)},expression:"plugInInfo.type"}},t._l(t.pluginTypeList,(function(e,a){return i("md-option",{key:a,attrs:{value:a}},[t._v(t._s(e))])})),1)],1)],1)]):t._e(),t.plugInInfo?i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("插件描述")]),i("md-input",{attrs:{value:t.plugInInfo.description,disabled:""}})],1)],1)]):t._e()]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.plugAddSetting,expression:"plugAddSetting"}]},[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("名称")]),i("md-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)]),t.plugInInfo?i("div",t._l(t.form.config,(function(e,a){return i("div",{key:a,staticClass:"md-layout md-gutter"},["http_headers"===a?i("div",{staticClass:"md-layout-item"},[i("label",[t._v(t._s(a))]),t.form.config["http_headers"].length>0?i("div",{staticStyle:{"padding-left":"30px"}},t._l(t.form.config["http_headers"],(function(e,a){return i("div",{key:a,staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item md-size-20"},[i("md-field",[i("label",[t._v("key")]),i("md-input",{model:{value:t.form.config["http_headers"][a].key,callback:function(e){t.$set(t.form.config["http_headers"][a],"key","string"===typeof e?e.trim():e)},expression:"form.config['http_headers'][header_index].key"}})],1)],1),i("div",{staticClass:"md-layout-item md-size-40"},[i("md-field",[i("label",[t._v("value")]),i("md-input",{model:{value:t.form.config["http_headers"][a].value,callback:function(e){t.$set(t.form.config["http_headers"][a],"value","string"===typeof e?e.trim():e)},expression:"form.config['http_headers'][header_index].value"}})],1)],1),i("div",{staticClass:"md-layout-item md-size-20 header-op"},[i("i",{staticClass:"iconfont icon-tianjia",on:{click:t.addHeader}}),0!=a?i("i",{staticClass:"iconfont icon-jian",on:{click:function(e){return t.removeHeader(a)}}}):t._e()])])})),0):t._e()]):i("div",{staticClass:"md-layout-item"},"allow_credential"===a?[i("label",{staticClass:"form-label"},[t._v("allow_credential：")]),i("md-switch",{staticClass:"md-primary ",model:{value:t.form.config.allow_credential,callback:function(e){t.$set(t.form.config,"allow_credential",e)},expression:"form.config.allow_credential"}})]:[i("md-field",[i("label",[t._v(t._s(a))]),i("md-input",{model:{value:t.form.config[a],callback:function(e){t.$set(t.form.config,a,e)},expression:"form.config[index]"}})],1)],1)])})),0):t._e(),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("label",{staticClass:"form-label"},[t._v("启用：")]),i("md-switch",{staticClass:"md-primary",model:{value:t.form.enable,callback:function(e){t.$set(t.form,"enable",e)},expression:"form.enable"}})],1)])]),i("div",{staticClass:"service-button"},[i("md-button",{staticClass:"md-raised md-mini",on:{click:function(e){t.addPlugin=!1}}},[t._v("取消")]),i("md-button",{staticClass:"md-raised md-mini md-primary",on:{click:t.submitForm}},[t._v("保存")])],1)]),i("div",{staticClass:"plug-table md-clear top-20"},[t._m(0),t._l(t.pluginList,(function(e,a){return i("div",{key:a,staticClass:"plug-tr"},[i("div",{staticClass:"plug-td",staticStyle:{width:"45px",cursor:"pointer"}},[i("i",{staticClass:"iconfont",class:t.arrowClass(e.is_edit),on:{click:function(i){return t.editShow(e,!e.is_edit)}}})]),i("div",{staticClass:"plug-td",staticStyle:{width:"40px"}},[i("i",{staticClass:"iconfont",class:[e.icon,e.color]})]),i("div",{staticClass:"plug-td font-bold",staticStyle:{width:"250px"}},[t._v(" "+t._s(e.name)+" ")]),i("div",{staticClass:"plug-td",class:[e.color],staticStyle:{width:"110px"}},[t._v(" "+t._s(e.plugin_key)+" ")]),i("div",{staticClass:"plug-td",class:[e.color],staticStyle:{width:"60px"}},[t._v(" "+t._s(e.type_name)+" ")]),i("div",{staticClass:"plug-td",staticStyle:{width:"240px"}},[t._v(" "+t._s(e.plugin_description)+" ")]),i("div",{staticClass:"plug-td",staticStyle:{width:"70px"}},[i("md-switch",{staticClass:"md-primary",on:{change:function(i){return t.putSwitchEnable(e)}},model:{value:e.enable,callback:function(i){t.$set(e,"enable",i)},expression:"item.enable"}})],1),i("div",{staticClass:"plug-td list_manage",staticStyle:{width:"100px"}},[i("i",{staticClass:"iconfont icon-xiugai",on:{click:function(i){return t.editShow(e,!0)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("修改")])],1),i("i",{staticClass:"iconfont icon-shanchu",on:{click:function(i){return t.deleteRoutePlugin(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("删除")])],1)]),e.is_edit?i("div",{key:e.res_id,staticClass:"plug-tr-form"},[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("名称")]),i("md-input",{model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"item.name"}})],1)],1)]),t._l(e.config,(function(s,n){return i("md-field",{key:n},["http_headers"===n?i("div",[i("label",[t._v(t._s(n))]),e.config["http_headers"].length>0?i("div",{staticStyle:{"padding-left":"30px","padding-top":"30px"}},t._l(e.config["http_headers"],(function(s,n){return i("div",{key:n,staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item md-size-30"},[i("md-field",[i("label",[t._v("key")]),i("md-input",{model:{value:e.config["http_headers"][n].key,callback:function(i){t.$set(e.config["http_headers"][n],"key","string"===typeof i?i.trim():i)},expression:"item.config['http_headers'][header_index].key"}})],1)],1),i("div",{staticClass:"md-layout-item md-size-60"},[i("md-field",[i("label",[t._v("value")]),i("md-input",{model:{value:e.config["http_headers"][n].value,callback:function(i){t.$set(e.config["http_headers"][n],"value","string"===typeof i?i.trim():i)},expression:"item.config['http_headers'][header_index].value"}})],1)],1),i("div",{staticClass:"md-layout-item md-size-10 header-op"},[i("i",{staticClass:"iconfont icon-tianjia",on:{click:function(e){return t.addEditHeader(a)}}}),0!=n?i("i",{staticClass:"iconfont icon-jian",on:{click:function(e){return t.removeEditHeader(a,n)}}}):t._e()])])})),0):t._e()]):"allow_credential"===n?i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("label",{staticClass:"form-label"},[t._v("allow_credential：")]),i("md-switch",{staticClass:"md-primary",staticStyle:{"margin-left":"120px","margin-top":"10px"},model:{value:e.config.allow_credential,callback:function(i){t.$set(e.config,"allow_credential",i)},expression:"item.config.allow_credential"}})],1)]):i("div",{staticClass:"md-layout-item"},[i("label",[t._v(t._s(n))]),i("md-input",{model:{value:e.config[n],callback:function(i){t.$set(e.config,n,i)},expression:"item.config[label]"}})],1)])})),i("div",{staticClass:"service-button"},[i("md-button",{staticClass:"md-raised",on:{click:function(i){return t.editShow(e,!1)}}},[t._v("取消")]),i("md-button",{staticClass:"md-raised md-primary",on:{click:function(i){return t.configSubmit(e)}}},[t._v("保存")])],1)],2):t._e()])}))],2)],1)},$t=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"plug-thtr"},[i("div",{staticClass:"plug-th",staticStyle:{width:"45px"}},[t._v("展开")]),i("div",{staticClass:"plug-th",staticStyle:{width:"40px"}}),i("div",{staticClass:"plug-th",staticStyle:{width:"250px"}},[t._v("名称")]),i("div",{staticClass:"plug-th",staticStyle:{width:"110px"}},[t._v("标识")]),i("div",{staticClass:"plug-th",staticStyle:{width:"60px"}},[t._v("类型")]),i("div",{staticClass:"plug-th",staticStyle:{width:"240px"}},[t._v("描述")]),i("div",{staticClass:"plug-th",staticStyle:{width:"70px"}},[t._v("启用")]),i("div",{staticClass:"plug-th",staticStyle:{width:"100px"}},[t._v("操作")])])}],Pt={typeList:function(){return k("admin/plugin/type-list")},addPluginList:function(){return k("admin/plugin/add-list",null)},info:function(t){return k("admin/plugin/info/"+t)},pluginConfigList:function(t,e){return 1===t?k("admin/service/plugin/config/list/"+e,null):2===t?k("admin/router/plugin/config/list/"+e,null):void 0},pluginConfigAdd:function(t,e){return 1===t?k("admin/service/plugin/config/add",e,"post"):2===t?k("admin/router/plugin/config/add",e,"post"):void 0},pluginConfigUpdate:function(t,e,i){return 1===t?k("admin/service/plugin/config/update/"+e,i,"put"):2===t?k("admin/router/plugin/config/update/"+e,i,"put"):void 0},pluginConfigSwitchEnable:function(t,e,i){return 1===t?k("admin/service/plugin/config/switch/enable/"+e,{enable:i},"put"):2===t?k("admin/router/plugin/config/switch/enable/"+e,{enable:i},"put"):void 0},pluginConfigDelete:function(t,e){return 1===t?k("admin/service/plugin/config/delete/"+e,null,"delete"):2===t?k("admin/router/plugin/config/delete/"+e,null,"delete"):void 0}},St={name:"List",props:{pluginConfigType:{type:Number,default:0},targetResId:{type:String,default:""}},data:function(){return{addPlugin:!1,plugAddInfo:!0,plugAddSetting:!1,pluginList:[],pluginSettingList:[],pluginTypeList:{},plugInInfo:null,pluginMockHeader:{key:"",value:""},pluginKey:"",form:{name:"",plugin_id:"",type:this.pluginConfigType,target_id:this.targetResId,enable:2,config:{}}}},mounted:function(){var t=this;this.targetResId&&this.getPluginType().then((function(){t.targetResId.length>0&&0!==t.pluginConfigType&&t.getList()}))},methods:{getPluginType:function(){var t=this;return Pt.typeList().then((function(e){var i={};0===e.code&&e.data.forEach((function(t,e){i[t.id]=t.name})),t.pluginTypeList=i}))},getList:function(){var t=this;Pt.pluginConfigList(this.pluginConfigType,this.targetResId).then((function(e){0===e.code&&(t.pluginList=e.data["list"]||[],t.pluginList.length>0&&t.pluginList.forEach((function(e,i){if(e.is_edit=!1,e.type_name=t.pluginTypeList[e.plugin_type]||"",e.enable=1===e.enable,!0===e.enable?e.color="color-plugin-"+e.plugin_type:e.color="color-plugin-0",0===e.icon.length&&(e.icon="icon-apex_plugin1"),"mock"===e.plugin_key){var a=e.config.http_headers;e.config.http_headers=[];var s=Object.keys(a);s.length>0?s.forEach((function(t,i){e.config.http_headers.push({key:t,value:a[t]})})):e.config.http_headers.push(t.pluginMockHeader)}})))}))},addPluginForm:function(){this.addPlugin=!0,this.getAddPluginList()},getAddPluginList:function(){var t=this;Pt.addPluginList(this.serviceId,this.routeId).then((function(e){0===e.code&&(t.pluginSettingList=e.data||[])}))},pluginChange:function(t){var e=this;this.plugInInfo=null,Pt.info(t).then((function(t){if(0===t.code){if(e.plugInInfo=t.data,e.plugInInfo.enable=!1,e.form.config=t.data.config,e.pluginKey=e.plugInInfo.plugin_key,"mock"===e.plugInInfo.plugin_key){var i=e.plugInInfo.config.http_headers;e.plugInInfo.config.http_headers=[];var a=Object.keys(i);a.length>0?a.forEach((function(t,a){e.plugInInfo.config.http_headers.push({key:t,value:i[t]})})):e.plugInInfo.config.http_headers.push(e.pluginMockHeader)}}else e.$notify({message:t.msg})}))},addHeader:function(){this.form.config["http_headers"].push({key:"",value:""})},removeHeader:function(t){this.$delete(this.form.config["http_headers"],t)},submitForm:function(){var t=this,e=JSON.parse(JSON.stringify(this.form));if(e.enable=!0===e.enable?1:2,e.config.http_headers){var i=e.config.http_headers;if(e.config.http_headers={},i.length>0)for(var a=0,s=Object.keys(i);a<s.length;a++){var n=s[a];i[n].key.length>0&&i[n].value.length>0&&(e.config.http_headers[i[n].key]=i[n].value)}}e.config.http_code&&(e.config.http_code=e.config.http_code-0),e.config.max_age&&(e.config.max_age=e.config.max_age-0),e.config.rate&&(e.config.rate=e.config.rate-0),e.config.burst&&(e.config.burst=e.config.burst-0),e.config.time_window&&(e.config.time_window=e.config.time_window-0),e.config.count&&(e.config.count=e.config.count-0),e.config.default_conn_delay&&(e.config.default_conn_delay=e.config.default_conn_delay-0),Pt.pluginConfigAdd(this.pluginConfigType,e).then((function(e){0===e.code?(t.addPlugin=!1,t.getList(),t.$notify({message:e.msg,type:"primary"}),t.$emit("refreshList")):t.$notify({message:e.msg})}))},putSwitchEnable:function(t){var e=this,i=!0===t.enable?1:2;Pt.pluginConfigSwitchEnable(this.pluginConfigType,t.res_id,i).then((function(i){0===i.code?(e.$notify({message:i.msg,type:"primary"}),e.getList(),e.$emit("refreshList")):(t.enable=!t.enable,e.$notify({message:i.msg}))}))},deleteRoutePlugin:function(t){var e=this;this.$dialog.modal({title:"提示",content:"确认要删除插件？"}).then((function(){Pt.pluginConfigDelete(e.pluginConfigType,t.res_id).then((function(t){0===t.code?(e.$notify({message:t.msg,type:"primary"}),e.getList(),e.$emit("refreshList")):e.$notify({message:t.msg})}))}))},editShow:function(t,e){t.is_edit=e,this.$forceUpdate()},addEditHeader:function(t){this.pluginList[t].config["http_headers"].push({key:"",value:""})},removeEditHeader:function(t,e){this.$delete(this.pluginList[t].config["http_headers"],e)},configSubmit:function(t){var e=this,i={name:t.name,config:t.config};if(i.config.http_headers){var a=i.config.http_headers;if(i.config.http_headers={},a.length>0)for(var s=0,n=Object.keys(a);s<n.length;s++){var o=n[s];a[o].key.length>0&&a[o].value.length>0&&(i.config.http_headers[a[o].key]=a[o].value)}}i.config.http_code&&(i.config.http_code=i.config.http_code-0),i.config.max_age&&(i.config.max_age=i.config.max_age-0),i.config.rate&&(i.config.rate=i.config.rate-0),i.config.burst&&(i.config.burst=i.config.burst-0),i.config.time_window&&(i.config.time_window=i.config.time_window-0),i.config.count&&(i.config.count=i.config.count-0),i.config.default_conn_delay&&(i.config.default_conn_delay=i.config.default_conn_delay-0),Pt.pluginConfigUpdate(this.pluginConfigType,t.res_id,i).then((function(t){0===t.code?(e.$notify({message:t.msg,type:"primary"}),e.getList(),e.$emit("refreshList")):e.$notify({message:t.msg})}))},plugTab:function(t){this.plugAddInfo=!1,this.plugAddSetting=!1,this[t]=!0},arrowClass:function(t){return t?"icon-xiajiantou":"icon-arrowright"}}},xt=St,It=(i("52a7"),Object(c["a"])(xt,kt,$t,!1,null,"4a3c4e4c",null)),Lt=It.exports,Tt={components:{ListHeader:lt,Drawer:wt,Pager:it,ServiceModify:vt,PluginList:Lt},data:function(){return{sidebarBackground:"blue",drawerDisplay:!1,drawerPluginDisplay:!1,serviceParams:{protocol:null,enable:null,search:""},page:1,page_size:10,currentPage:1,serviceList:[],total:0,currentServiceResId:"",pluginServiceResId:"",pluginConfigType:1,isShow:!0,isPluginShow:!0,active:!1,isTab:!1}},mounted:function(){this.getList()},methods:{handleCurrentChange:function(t){this.page=t.currentPage,this.getList()},saveHandle:function(){this.drawerDisplay=!1,this.getList()},refreshList:function(){this.getList()},closeDrawer:function(){this.drawerDisplay=!1},getList:function(){var t=this,e=JSON.parse(JSON.stringify(this.serviceParams));e.page=this.page,e.page_size=this.page_size,ut.getList(e).then((function(e){0===e.code&&(t.total=e.data["total"],t.serviceList=e.data["data"],t.serviceList.forEach((function(t){t.enable=1===t.enable,t.edit_name=!1,t.plugin_list.length>0&&t.plugin_list.forEach((function(t,e){1===t.enable?t.color="color-plugin-"+t.type:t.color="color-plugin-0",0===t.icon.length&&(t.icon="icon-apex_plugin1")}))})))}))},drawerService:function(t){var e=this;this.isShow=!1,this.$nextTick((function(){e.isShow=!0})),this.currentServiceResId=t.res_id,this.drawerDisplay=!0},drawerPlugin:function(t){var e=this;this.isPluginShow=!1,this.$nextTick((function(){e.isPluginShow=!0})),this.pluginServiceResId=t.res_id,this.drawerPluginDisplay=!0},editServiceName:function(t){t.edit_name=!0,this.$forceUpdate()},saveServiceName:function(t){var e=this;ut.putName(t.res_id,t.name).then((function(i){0!==i.code?e.$notify({message:i.msg}):(t.edit_name=!1,e.$forceUpdate(),e.$notify({message:i.msg,type:"primary"}))}))},deleteService:function(t){var e=this;this.$dialog.modal({title:"提示",content:"确认要删除服务？"}).then((function(){ut.delete(t.res_id).then((function(t){0===t.code||e.$notify({message:t.msg}),e.getList()}))}))},putSwitchRelease:function(t){var e=this;3!==t.release?ut.putSwitchRelease(t.res_id).then((function(t){0!==t.code?(e.$notify({message:t.msg}),e.getList()):(e.$notify({message:t.msg,type:"primary"}),e.getList())})):this.$notify({message:"配置已发布"})},putSwitchEnable:function(t){var e=this,i=!0===t.enable?1:2;ut.putSwitchEnable(t.res_id,i).then((function(i){0!==i.code?(t.enable=!t.enable,e.$notify({message:i.msg}),e.getList()):(e.$notify({message:i.msg,type:"primary"}),e.getList())}))}},watch:{serviceParams:{handler:function(){this.page=1,this.currentPage=1,this.getList(),this.isTab=!0},deep:!0}}},Rt=Tt,Nt=(i("e9cc"),Object(c["a"])(Rt,X,Y,!1,null,"570be4c4",null)),Ot=Nt.exports,Dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("div",{staticClass:"md-layout"},[i("div",{staticClass:"md-layout-item md-medium-size-100 md-xsmall-size-100 md-size-100"},[i("md-card",[i("list-header",{attrs:{"sidebar-item-color":t.sidebarBackground,icon:"icon-lianjie",title:"路由管理",title_href:"Router"}}),i("md-card-content",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("所属服务")]),i("md-select",{attrs:{name:"service_res_id",id:"service_res_id","md-dense":""},model:{value:t.routerParams.service_res_id,callback:function(e){t.$set(t.routerParams,"service_res_id",e)},expression:"routerParams.service_res_id"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),t._l(t.serviceNameList,(function(e,a){return i("md-option",{key:a,attrs:{value:e.res_id}},[t._v(t._s(e.name))])}))],2)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("启用状态")]),i("md-select",{attrs:{name:"enable",id:"enable","md-dense":""},model:{value:t.routerParams.enable,callback:function(e){t.$set(t.routerParams,"enable",e)},expression:"routerParams.enable"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("启用")]),i("md-option",{attrs:{value:"2"}},[t._v("停用")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("发布状态")]),i("md-select",{attrs:{name:"release",id:"release","md-dense":""},model:{value:t.routerParams.release,callback:function(e){t.$set(t.routerParams,"release",e)},expression:"routerParams.release"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("未发布")]),i("md-option",{attrs:{value:"2"}},[t._v("待发布")]),i("md-option",{attrs:{value:"3"}},[t._v("已发布")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("搜索内容")]),i("md-input",{attrs:{type:"text"},model:{value:t.routerParams.search,callback:function(e){t.$set(t.routerParams,"search",e)},expression:"routerParams.search"}})],1)],1),i("div",{staticClass:"md-layout-item text-right"},[i("md-button",{staticClass:"md-raised md-primary addNode",on:{click:function(e){return t.drawerRouter("")}}},[i("i",{staticClass:"iconfont icon-addNode"}),t._v(" 新增路由 ")])],1)])])],1),i("md-card",[i("md-card-content",[i("md-table",[i("md-table-row",{staticClass:"md-head"},[i("md-table-head",[t._v("ID/名称")]),i("md-table-head",[t._v("服务")]),i("md-table-head",[t._v("方法")]),i("md-table-head",[t._v("路径")]),i("md-table-head",[t._v("插件")]),i("md-table-head",[t._v(" 发布 "),i("i",{staticClass:"iconfont icon-help color-orange"},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(" 未发布：新增但未发布到数据面"),i("br"),t._v(" 待发布：当前配置与数据面不符"),i("br"),t._v(" 已发布：当前配置已发布数据面 ")])],1)]),i("md-table-head",[t._v("启用")]),i("md-table-head",[t._v("操作")])],1),t._l(t.routerList,(function(e,a){return i("md-table-row",{key:a},[i("md-table-cell",[i("span",{staticClass:"font-link-color",on:{click:function(i){return t.drawerRouter(e)}}},[t._v(" "+t._s(e.res_id)+" ")]),i("br"),e.edit_name?i("md-field",{staticClass:"field-edit-name"},[i("md-input",{on:{blur:function(i){return t.saveRouterName(e)}},model:{value:e.router_name,callback:function(i){t.$set(e,"router_name",i)},expression:"item.router_name"}})],1):i("span",[t._v(" "+t._s(e.router_name)+" "),i("i",{staticClass:"iconfont icon-xiugai",on:{click:function(i){return t.editRouterName(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("修改名称")])],1)])],1),i("md-table-cell",[t._v(" "+t._s(e.service_name)+" ")]),i("md-table-cell",t._l(e.request_methods,(function(e,a){return i("span",{key:a},["ALL"===e?i("span",{staticClass:"font-block background-color-black"},[t._v(" "+t._s(e)+" ")]):t._e(),"GET"===e?i("span",{staticClass:"font-block background-color-green"},[t._v(" "+t._s(e)+" ")]):t._e(),"POST"===e?i("span",{staticClass:"font-block background-color-orange"},[t._v(" "+t._s(e)+" ")]):t._e(),"PUT"===e?i("span",{staticClass:"font-block background-color-blue"},[t._v(" "+t._s(e)+" ")]):t._e(),"DELETE"===e?i("span",{staticClass:"font-block background-color-red"},[t._v(" "+t._s(e)+" ")]):t._e(),"OPTIONS"===e?i("span",{staticClass:"font-block background-color-purple"},[t._v(" "+t._s(e)+" ")]):t._e()])})),0),i("md-table-cell",[t._v(" "+t._s(e.router_path)+" ")]),i("md-table-cell",[e.plugin_list.length>0?i("div",t._l(e.plugin_list,(function(e,a){return i("i",{key:a,staticClass:"iconfont",class:[e.icon,e.color],staticStyle:{margin:"3px"}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v(t._s(e.name))])],1)})),0):i("div")]),i("md-table-cell",[1===e.release?i("span",{staticClass:"color-grey font-bold"},[t._v("未发布")]):t._e(),2===e.release?i("span",{staticClass:"color-orange font-bold"},[t._v("待发布")]):t._e(),3===e.release?i("span",{staticClass:"color-green font-bold"},[t._v("已发布")]):t._e()]),i("md-table-cell",[i("md-switch",{staticClass:"md-primary",on:{change:function(i){return t.putSwitchEnable(e)}},model:{value:e.enable,callback:function(i){t.$set(e,"enable",i)},expression:"item.enable"}})],1),i("md-table-cell",{staticClass:"list_manage"},[3!==e.release?i("i",{staticClass:"iconfont icon-yuntongbu",on:{click:function(i){return t.putSwitchRelease(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("发布")])],1):t._e(),i("a",{attrs:{href:"javascript:void(0);"},on:{click:function(i){return t.drawerRouterPlugin(e)}}},[i("i",{staticClass:"iconfont icon-chajiangongneng"},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("插件")])],1)]),i("a",{attrs:{href:"javascript:void(0);"},on:{click:function(i){return t.copyRouter(e)}}},[i("i",{staticClass:"iconfont icon-fuzhi"},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("复制")])],1)]),i("i",{staticClass:"iconfont icon-xiugai",on:{click:function(i){return t.drawerRouter(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("修改")])],1),i("i",{staticClass:"iconfont icon-shanchu",on:{click:function(i){return t.deleteRouter(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("删除")])],1)])],1)}))],2),t.total>0?i("Pager",{attrs:{pageSize:t.page_size,"current-pages":t.currentPage,totals:t.total,tab:t.isTab},on:{"current-change":t.handleCurrentChange}}):t._e()],1)],1)],1)]),i("Drawer",{attrs:{title:t.currentRouterResId?"路由编辑":"新增路由",display:t.drawerRouterDisplay,width:"700px",inner:!0},on:{"update:display":function(e){t.drawerRouterDisplay=e}}},[t.isDrawerRouterShow?i("RouterModify",{attrs:{serviceResId:t.serviceResId,routerResId:t.currentRouterResId},on:{closeDrawer:function(e){t.drawerRouterDisplay=!1},saveHandle:t.saveHandle}}):t._e()],1),i("Drawer",{attrs:{title:"插件列表",display:t.drawerPluginDisplay,inner:!0,width:"960px"},on:{"update:display":function(e){t.drawerPluginDisplay=e}}},[t.isDrawerPluginShow?i("PluginList",{attrs:{serviceResId:t.serviceResId,targetResId:t.pluginRouterResId,pluginConfigType:t.pluginConfigType},on:{refreshList:t.refreshList}}):t._e()],1)],1)},jt=[],Et=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",[i("div",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("路由名称")]),i("md-input",{model:{value:t.form.router_name,callback:function(e){t.$set(t.form,"router_name",e)},expression:"form.router_name"}})],1)],1)]),0===this.routerResId.length?i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item service_res_id"},[i("md-field",{class:t.getValidationClass("service_res_id")},[i("label",[t._v("所属服务")]),i("md-select",{attrs:{name:"service_res_id",id:"service_res_id","md-dense":"",required:""},model:{value:t.form.service_res_id,callback:function(e){t.$set(t.form,"service_res_id",e)},expression:"form.service_res_id"}},t._l(t.serviceNameList,(function(e,a){return i("md-option",{key:a,attrs:{value:e.res_id}},[t._v(t._s(e.name))])})),1),t.$v.form.service_res_id.required?t._e():i("span",{staticClass:"md-error"},[t._v("所属服务不能为空")])],1)],1)]):t._e(),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item router_path"},[i("md-field",{class:t.getValidationClass("router_path")},[i("label",[t._v("路由路径")]),i("md-input",{attrs:{required:""},model:{value:t.form.router_path,callback:function(e){t.$set(t.form,"router_path",e)},expression:"form.router_path"}}),t.$v.form.router_path.required?t._e():i("span",{staticClass:"md-error"},[t._v("路由路径不能为空")])],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item request_methods"},[i("md-field",{class:t.getValidationClass("request_methods")},[i("label",[t._v("请求方法")]),i("md-select",{attrs:{name:"request_methods",id:"request_methods","md-dense":"",multiple:"",required:""},model:{value:t.form.request_methods,callback:function(e){t.$set(t.form,"request_methods",e)},expression:"form.request_methods"}},[i("md-option",{attrs:{value:"ALL"}},[t._v("ALL")]),i("md-option",{attrs:{value:"GET"}},[t._v("GET")]),i("md-option",{attrs:{value:"POST"}},[t._v("POST")]),i("md-option",{attrs:{value:"PUT"}},[t._v("PUT")]),i("md-option",{attrs:{value:"DELETE"}},[t._v("DELETE")])],1),t.$v.form.request_methods.required?t._e():i("span",{staticClass:"md-error"},[t._v("请求方法不能为空")])],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"form-item"},[i("label",{staticClass:"form-label"},[t._v("启用：")]),i("md-switch",{staticClass:"md-primary",model:{value:t.form.enable,callback:function(e){t.$set(t.form,"enable",e)},expression:"form.enable"}})],1)]),t.form.upstream_nodes.length>0?i("div",t._l(t.$v.form.upstream_nodes.$each.$iter,(function(e,a){return i("div",{key:a,staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item md-size-40"},[i("md-field",{class:t.getValidationClass("upstream_nodes")},[i("label",[t._v("上游节点")]),i("md-input",{model:{value:t.form.upstream_nodes[a].node_ip,callback:function(e){t.$set(t.form.upstream_nodes[a],"node_ip","string"===typeof e?e.trim():e)},expression:"form.upstream_nodes[index].node_ip"}}),e.node_ip.ipAddress?t._e():i("span",{staticClass:"md-error"},[t._v("上游节点格式有误")])],1)],1),i("div",{staticClass:"md-layout-item md-size-20"},[i("md-field",{class:t.getValidationClass("upstream_nodes")},[i("label",[t._v("端口")]),i("md-input",{model:{value:t.form.upstream_nodes[a].node_port,callback:function(e){t.$set(t.form.upstream_nodes[a],"node_port",t._n(e))},expression:"form.upstream_nodes[index].node_port"}}),e.node_port.between?t._e():i("span",{staticClass:"md-error"},[t._v("端口范围应在1~65535之间")])],1)],1),i("div",{staticClass:"md-layout-item md-size-20"},[i("md-field",{class:t.getValidationClass("upstream_nodes")},[i("label",[t._v("权重")]),i("md-input",{model:{value:t.form.upstream_nodes[a].node_weight,callback:function(e){t.$set(t.form.upstream_nodes[a],"node_weight",t._n(e))},expression:"form.upstream_nodes[index].node_weight"}}),e.node_weight.between?t._e():i("span",{staticClass:"md-error"},[t._v("端口范围应在1~100之间")])],1)],1),i("div",{staticClass:"md-layout-item md-size-20 upstream-node-op"},[i("i",{staticClass:"iconfont icon-tianjia",on:{click:t.addNode}}),0!=a?i("i",{staticClass:"iconfont icon-jian",on:{click:function(e){return t.removeNode(a)}}}):t._e()])])})),0):t._e(),i("div",{staticClass:"modify-advanced"},[i("div",{staticClass:"modify-advanced-click",on:{click:function(e){t.isAdvanced=!t.isAdvanced}}},[t._v(" 高级配置 "),i("i",{staticClass:"iconfont",class:{"icon-xiajiantou":!1===t.isAdvanced,"icon-shangjiantou":!0===t.isAdvanced}})]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isAdvanced,expression:"isAdvanced"}]},[i("div",{staticClass:"form-item"},[i("md-field",[i("label",[t._v("负载均衡")]),i("md-select",{attrs:{name:"load_balance",id:"load_balance","md-dense":""},model:{value:t.form.load_balance,callback:function(e){t.$set(t.form,"load_balance",t._n(e))},expression:"form.load_balance"}},[i("md-option",{attrs:{value:"1"}},[t._v("加权轮询（Round Robin）")]),i("md-option",{attrs:{value:"2"}},[t._v("一致性Hash（CHash）")])],1)],1)],1),i("div",{staticClass:"form-item"},[i("md-field",{class:t.getValidationClass("connect_timeout")},[i("label",[t._v("连接超时（毫秒）")]),i("md-input",{model:{value:t.form.connect_timeout,callback:function(e){t.$set(t.form,"connect_timeout",t._n(e))},expression:"form.connect_timeout"}}),t.$v.form.connect_timeout.integer?t._e():i("span",{staticClass:"md-error"},[t._v("连接超时内容必须为1~600000的数字")])],1)],1),i("div",{staticClass:"form-item"},[i("md-field",{class:t.getValidationClass("write_timeout")},[i("label",[t._v("写超时（毫秒）")]),i("md-input",{model:{value:t.form.write_timeout,callback:function(e){t.$set(t.form,"write_timeout",t._n(e))},expression:"form.write_timeout"}}),t.$v.form.write_timeout.integer?t._e():i("span",{staticClass:"md-error"},[t._v("写超时内容必须为1~600000的数字")])],1)],1),i("div",{staticClass:"form-item"},[i("md-field",{class:t.getValidationClass("read_timeout")},[i("label",[t._v("读超时（毫秒）")]),i("md-input",{model:{value:t.form.read_timeout,callback:function(e){t.$set(t.form,"read_timeout",t._n(e))},expression:"form.read_timeout"}}),t.$v.form.read_timeout.integer?t._e():i("span",{staticClass:"md-error"},[t._v("读超时内容必须为1~600000的数字")])],1)],1)])]),i("div",{staticClass:"modify-button"},[i("md-button",{staticClass:"md-raised",on:{click:function(e){return t.$emit("closeDrawer")}}},[t._v("取消")]),i("md-button",{staticClass:"md-raised md-primary",on:{click:t.submitForm}},[t._v("保存")])],1)])])},qt=[],zt=(i("0240"),{getList:function(t){return k("admin/router/list",t)},info:function(t,e){return k("admin/router/info/"+t+"/"+e)},post:function(t){return k("admin/router/add",t,"post")},put:function(t,e,i){return k("admin/router/update/"+t+"/"+e,i,"put")},copy:function(t,e){return k("admin/router/copy/"+t+"/"+e,null,"post")},putName:function(t,e,i){return k("admin/router/update/name/"+t+"/"+e,{name:i},"put")},putSwitchRelease:function(t,e){return k("admin/router/switch/release/"+t+"/"+e,null,"put")},putSwitchEnable:function(t,e,i){return k("admin/router/switch/enable/"+t+"/"+e,{enable:i},"put")},delete:function(t,e){return k("admin/router/delete/"+t+"/"+e,null,"delete")}}),At={name:"RouterModify",props:{serviceResId:{type:String,default:""},routerResId:{type:String,default:""}},data:function(){return{isAdvanced:!1,form:{router_name:"",service_res_id:this.$serviceResId,request_methods:[],router_path:"",enable:2,upstream_res_id:"",upstream_nodes:[],load_balance:1,read_timeout:3e3,write_timeout:3e3,connect_timeout:3e3},serviceNameList:[]}},validations:{form:{service_res_id:{required:mt["required"]},router_path:{required:mt["required"]},request_methods:{required:mt["required"]},upstream_nodes:{$each:{node_ip:{ipAddress:mt["ipAddress"]},node_port:{between:Object(mt["between"])(1,65535)},node_weight:{between:Object(mt["between"])(1,100)}}},load_balance:{between:Object(mt["between"])(1,2)},read_timeout:{integer:mt["integer"],between:Object(mt["between"])(1,6e5)},write_timeout:{integer:mt["integer"],between:Object(mt["between"])(1,6e5)},connect_timeout:{integer:mt["integer"],between:Object(mt["between"])(1,6e5)}}},mounted:function(){this.routerResId&&(this.isAdvanced=!0),this.getInfo(),this.getServiceNameList()},methods:{getValidationClass:function(t){var e=this.$v.form[t];if(e)return{"md-invalid":e.$invalid&&e.$dirty}},getServiceNameList:function(){var t=this;ut.getNameList().then((function(e){0===e.code&&(t.serviceNameList=e.data)}))},getInfo:function(){var t=this,e=[{node_ip:"",node_port:"",node_weight:""}];this.form.upstream_nodes=e,0!==this.routerResId.length&&zt.info(this.serviceResId,this.routerResId).then((function(i){if(0!==i.code)return t.$notify({message:i.msg}),t.$emit("saveHandle");for(var a=0,s=Object.keys(t.form);a<s.length;a++){var n=s[a];t.form[n]=i.data[n]}t.form.enable=1===t.form.enable,0===i.data.upstream_nodes.length&&(t.form.upstream_nodes=e),0===i.data.upstream_res_id.length?(t.form.load_balance="",t.form.read_timeout="",t.form.write_timeout="",t.form.connect_timeout=""):(t.form.load_balance=i.data.upstream.algorithm,t.form.read_timeout=i.data.upstream.read_timeout,t.form.write_timeout=i.data.upstream.write_timeout,t.form.connect_timeout=i.data.upstream.connect_timeout)}))},submitForm:function(){var t=this;if(this.$v.$touch(),!this.$v.$invalid){var e,i=JSON.parse(JSON.stringify(this.form));i.enable=!0===i.enable?1:2,i.request_methods=i.request_methods.join(",");var a=i.upstream_nodes;if(i.upstream_nodes=[],a.length>0)for(var s=0,n=Object.keys(a);s<n.length;s++){var o=n[s];a[o].node_ip.length>0&&i.upstream_nodes.push(a[o])}"string"===typeof i.load_balance&&(i.load_balance=1);var r=3e3;"string"===typeof i.read_timeout&&(i.read_timeout=r),"string"===typeof i.write_timeout&&(i.write_timeout=r),"string"===typeof i.connect_timeout&&(i.connect_timeout=r),e=this.routerResId?zt.put(i.service_res_id,this.routerResId,i):zt.post(i),e.then((function(e){if(0===e.code)return t.$notify({message:e.msg,type:"primary"}),t.$emit("saveHandle");t.$notify({message:e.msg})}))}},addNode:function(){this.form.upstream_nodes.push({node_ip:"",node_port:"",node_weight:""})},removeNode:function(t){this.$delete(this.form.upstream_nodes,t)}}},Ht=At,Mt=(i("ede3"),Object(c["a"])(Ht,Et,qt,!1,null,"48e4d392",null)),Bt=Mt.exports,Vt={components:{ListHeader:lt,Drawer:wt,Pager:it,RouterModify:Bt,PluginList:Lt},data:function(){return{sidebarBackground:"blue",routerParams:{service_res_id:this.$route.params.service_res_id,enable:null,release:null,search:""},page:1,page_size:10,currentPage:1,routerList:[],serviceNameList:[],total:0,serviceResId:"",currentRouterResId:"",pluginRouterResId:"",pluginConfigType:2,drawerRouterDisplay:!1,drawerPluginDisplay:!1,isDrawerRouterShow:!0,isDrawerPluginShow:!0,isTab:!1}},mounted:function(){this.getServiceNameList(),this.getList()},methods:{handleCurrentChange:function(t){this.page=t.currentPage,this.getList()},saveHandle:function(){this.drawerRouterDisplay=!1,this.getList()},refreshList:function(){this.getList()},getList:function(){var t=this,e=JSON.parse(JSON.stringify(this.routerParams));e.page=this.page,e.page_size=this.page_size,zt.getList(e).then((function(e){0===e.code&&(t.total=e.data["total"],t.routerList=e.data["data"],t.routerList.length>0&&t.routerList.forEach((function(t){t.enable=1===t.enable,t.edit_name=!1,t.plugin_list.length>0&&t.plugin_list.forEach((function(t,e){1===t.enable?t.color="color-plugin-"+t.type:t.color="color-plugin-0",0===t.icon.length&&(t.icon="icon-apex_plugin1")}))})))}))},getServiceNameList:function(){var t=this;ut.getNameList().then((function(e){0===e.code&&(t.serviceNameList=e.data)}))},drawerRouter:function(t){var e=this;this.isDrawerRouterShow=!1,this.$nextTick((function(){e.isDrawerRouterShow=!0})),this.serviceResId=t.service_res_id,this.currentRouterResId=t.res_id,this.drawerRouterDisplay=!0},drawerRouterPlugin:function(t){var e=this;this.isDrawerPluginShow=!1,this.$nextTick((function(){e.isDrawerPluginShow=!0})),this.pluginRouterResId=t.res_id,this.drawerPluginDisplay=!0},editRouterName:function(t){t.edit_name=!0,this.$forceUpdate()},saveRouterName:function(t){var e=this;zt.putName(t.service_res_id,t.res_id,t.router_name).then((function(i){0!==i.code?e.$notify({message:i.msg}):(t.edit_name=!1,e.$forceUpdate(),e.$notify({message:i.msg,type:"primary"}))}))},copyRouter:function(t){var e=this;this.$dialog.modal({title:"提示",content:"路由复制会将其下的插件全量复制？"}).then((function(){zt.copy(t.service_res_id,t.res_id).then((function(t){0===t.code||e.$notify({message:t.msg}),e.getList()}))}))},deleteRouter:function(t){var e=this;this.$dialog.modal({title:"提示",content:"确认要删除服务？"}).then((function(){zt.delete(t.service_res_id,t.res_id).then((function(t){0===t.code?e.getList():e.$notify({message:t.msg})}))}))},putSwitchRelease:function(t){var e=this;zt.putSwitchRelease(t.service_res_id,t.res_id).then((function(t){0!==t.code?e.$notify({message:t.msg}):(e.$notify({message:t.msg,type:"primary"}),e.getList())}))},putSwitchEnable:function(t){var e=this,i=!0===t.enable?1:2;zt.putSwitchEnable(t.service_res_id,t.res_id,i).then((function(i){0!==i.code?(t.enable=!t.enable,e.$notify({message:i.msg})):(e.$notify({message:i.msg,type:"primary"}),e.getList())}))}},watch:{routerParams:{handler:function(){this.page=1,this.currentPage=1,this.getList(),this.isTab=!0},deep:!0}}},Jt=Vt,Ft=(i("c1ce"),Object(c["a"])(Jt,Dt,jt,!1,null,"617227c5",null)),Ut=Ft.exports,Kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("div",{staticClass:"md-layout"},[i("div",{staticClass:"md-layout-item md-medium-size-100 md-xsmall-size-100 md-size-100"},[i("md-card",[i("list-header",{attrs:{"sidebar-item-color":t.sidebarBackground,icon:"icon-zhengshu-copy",title:"证书管理",title_href:"Certificate"}}),i("md-card-content",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("启用状态")]),i("md-select",{attrs:{"md-dense":"",id:"certParams.enable",name:"certParams.enable"},model:{value:t.certParams.enable,callback:function(e){t.$set(t.certParams,"enable",e)},expression:"certParams.enable"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("启用")]),i("md-option",{attrs:{value:"2"}},[t._v("停用")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("搜索内容")]),i("md-input",{model:{value:t.certParams.search,callback:function(e){t.$set(t.certParams,"search",e)},expression:"certParams.search"}})],1)],1),i("div",{staticClass:"md-layout-item text-right"},[i("md-button",{staticClass:"md-raised md-primary addNode",on:{click:function(e){return t.drawerCertificate("")}}},[i("i",{staticClass:"iconfont icon-addNode"}),t._v(" 新增证书")])],1)])])],1),i("md-card",[i("md-card-content",[i("md-table",[i("md-table-row",{staticClass:"md-head"},[i("md-table-head",[t._v("ID")]),i("md-table-head",[t._v("域名")]),i("md-table-head",[t._v("过期时间")]),i("md-table-head",[t._v("启用")]),i("md-table-head",[t._v("操作")])],1),t._l(t.certificateList,(function(e,a){return i("md-table-row",{key:a},[i("md-table-cell",[t._v(" "+t._s(e.res_id)+" ")]),i("md-table-cell",[t._v(" "+t._s(e.sni)+" ")]),t.newTimeStamp>e.expired_at?i("md-table-cell",{staticClass:"color-red"},[t._v(" "+t._s(t._f("formatTime")(e.expired_at))+" ")]):i("md-table-cell",[t._v(" "+t._s(t._f("formatTime")(e.expired_at))+" ")]),i("md-table-cell",[i("md-switch",{staticClass:"md-primary",on:{change:function(i){return t.putSwitchEnable(e)}},model:{value:e.enable,callback:function(i){t.$set(e,"enable",i)},expression:"item.enable"}})],1),i("md-table-cell",{staticClass:"list_manage"},[i("i",{staticClass:"iconfont icon-xiugai",on:{click:function(i){return t.drawerCertificate(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("修改")])],1),i("i",{staticClass:"iconfont icon-shanchu",on:{click:function(i){return t.deleteCertificate(e)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("删除")])],1)])],1)}))],2),t.total>0?i("Pager",{attrs:{pageSize:t.page_size,"current-page":t.page,totals:t.total,tab:t.isTab},on:{"current-change":t.handleCurrentChange}}):t._e()],1)],1)],1)]),i("Drawer",{attrs:{title:t.currentCertificateId?"编辑证书":"新增证书",display:t.drawerDisplay,inner:!0,width:"700px"},on:{"update:display":function(e){t.drawerDisplay=e}}},[t.isShow?i("CertificateModify",{attrs:{certificateResId:t.currentCertificateId},on:{closeDrawer:function(e){t.drawerDisplay=!1},saveHandle:t.saveHandle}}):t._e()],1)],1)},Gt=[],Xt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",{class:t.getValidationClass("sni")},[i("label",[t._v("域名")]),i("md-input",{attrs:{required:""},model:{value:t.form.sni,callback:function(e){t.$set(t.form,"sni",e)},expression:"form.sni"}}),t.$v.form.sni.required?t._e():i("span",{staticClass:"md-error"},[t._v("域名不能为空")])],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",{class:t.getValidationClass("certificate")},[i("label",[t._v("证书内容")]),i("md-textarea",{attrs:{required:""},model:{value:t.form.certificate,callback:function(e){t.$set(t.form,"certificate",e)},expression:"form.certificate"}}),t.$v.form.certificate.required?t._e():i("span",{staticClass:"md-error"},[t._v("证书不能为空")])],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",{class:t.getValidationClass("private_key")},[i("label",[t._v("私钥内容")]),i("md-textarea",{attrs:{required:""},model:{value:t.form.private_key,callback:function(e){t.$set(t.form,"private_key",e)},expression:"form.private_key"}}),t.$v.form.private_key.required?t._e():i("span",{staticClass:"md-error"},[t._v("私钥内容不能为空")])],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"form-item"},[i("label",{staticClass:"form-label"},[t._v("启用：")]),i("md-switch",{staticClass:"md-primary",model:{value:t.form.enable,callback:function(e){t.$set(t.form,"enable",e)},expression:"form.enable"}})],1)]),i("div",{staticClass:"service-button"},[i("md-button",{staticClass:"md-raised",on:{click:function(e){return t.$emit("closeDrawer")}}},[t._v("取消")]),i("md-button",{staticClass:"md-raised md-primary",on:{click:t.submitForm}},[t._v("保存")])],1)])},Yt=[],Qt={getList:function(t){return k("admin/certificate/list",t)},info:function(t){return k("admin/certificate/info/"+t)},post:function(t){return k("admin/certificate/add",t,"post")},put:function(t,e){return k("admin/certificate/update/"+t,e,"put")},putSwitchEnable:function(t,e){return k("admin/certificate/switch/enable/"+t,{enable:e},"put")},delete:function(t){return k("admin/certificate/delete/"+t,null,"delete")}},Wt={name:"CertificateModify",props:{certificateResId:{type:String,default:""}},data:function(){return{form:{sni:"",certificate:null,private_key:null,enable:2}}},validations:{form:{sni:{required:mt["required"]},certificate:{required:mt["required"]},private_key:{required:mt["required"]}}},mounted:function(){this.getInfo()},methods:{getValidationClass:function(t){var e=this.$v.form[t];if(e)return{"md-invalid":e.$invalid&&e.$dirty}},getInfo:function(){var t=this;0!==this.certificateResId.length&&Qt.info(this.certificateResId).then((function(e){if(0!==e.code)return t.$notify({message:e.msg}),t.$emit("saveHandle");for(var i=0,a=Object.keys(t.form);i<a.length;i++){var s=a[i];t.form[s]=e.data[s]}t.form.enable=1===t.form.enable}))},submitForm:function(){var t=this;if(this.$v.$touch(),!this.$v.$invalid){var e,i=JSON.parse(JSON.stringify(this.form));i.enable=!0===i.enable?1:2,e=this.certificateResId?Qt.put(this.certificateResId,i):Qt.post(i),e.then((function(e){if(0===e.code)return t.$notify({message:e.msg,type:"primary"}),t.$emit("saveHandle");t.$notify({message:e.msg})}))}}}},Zt=Wt,te=(i("1722"),Object(c["a"])(Zt,Xt,Yt,!1,null,"40a66e49",null)),ee=te.exports,ie={components:{Drawer:wt,Pager:it,ListHeader:lt,CertificateModify:ee},data:function(){return{certParams:{enable:null,search:""},page:1,page_size:10,certificateList:[],total:0,isTab:!1,isShow:!0,drawerDisplay:!1,currentCertificateId:"",newTimeStamp:0,sidebarBackground:"blue"}},mounted:function(){this.getList()},methods:{handleCurrentChange:function(t){this.page=t.currentPage,this.getList()},saveHandle:function(){this.drawerDisplay=!1,this.getList()},getList:function(){var t=this,e=JSON.parse(JSON.stringify(this.certParams));e.page=this.page,e.page_size=this.page_size,Qt.getList(e).then((function(e){0===e.code&&(t.total=e.data["total"],t.certificateList=e.data["data"],t.certificateList.forEach((function(t){t.enable=1===t.enable})),t.newTimeStamp=Math.floor((new Date).getTime()/1e3))}))},putSwitchEnable:function(t){var e=this,i=!0===t.enable?1:2;Qt.putSwitchEnable(t.res_id,i).then((function(i){0!==i.code?(t.enable=!t.enable,e.$notify({message:i.msg})):(e.$notify({message:i.msg,type:"primary"}),e.getList())}))},drawerCertificate:function(t){var e=this;this.isShow=!1,this.$nextTick((function(){e.isShow=!0})),this.currentCertificateId=t.res_id,this.drawerDisplay=!0},deleteCertificate:function(t){var e=this;this.$dialog.modal({title:"提示",content:"确认要删除证书？"}).then((function(){Qt.delete(t.res_id).then((function(t){0===t.code?(e.$notify({message:t.msg,type:"primary"}),e.getList()):e.$notify({message:t.msg})}))}))}},watch:{certParams:{handler:function(){this.page=1,this.currentPage=1,this.getList(),this.isTab=!0},deep:!0}}},ae=ie,se=(i("0494"),Object(c["a"])(ae,Kt,Gt,!1,null,"1ba3dc42",null)),ne=se.exports,oe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("div",{staticClass:"md-layout"},[i("div",{staticClass:"md-layout-item md-medium-size-100 md-xsmall-size-100 md-size-100"},[i("md-card",[i("list-header",{attrs:{"sidebar-item-color":t.sidebarBackground,icon:"icon-jiedian",title:"节点管理",title_href:"ClusterNode"}}),i("md-card-content",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("IP类型")]),i("md-select",{attrs:{name:"ip_type",id:"ip_type","md-dense":""},model:{value:t.searchParams.ip_type,callback:function(e){t.$set(t.searchParams,"ip_type",e)},expression:"searchParams.ip_type"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("IPV4")]),i("md-option",{attrs:{value:"2"}},[t._v("IPV6")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("健康状态")]),i("md-select",{attrs:{name:"node_status",id:"node_status","md-dense":""},model:{value:t.searchParams.node_status,callback:function(e){t.$set(t.searchParams,"node_status",e)},expression:"searchParams.node_status"}},[i("md-option",{attrs:{value:"0"}},[t._v("全部")]),i("md-option",{attrs:{value:"1"}},[t._v("健康")]),i("md-option",{attrs:{value:"2"}},[t._v("异常")])],1)],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("搜索内容")]),i("md-input",{model:{value:t.searchParams.search,callback:function(e){t.$set(t.searchParams,"search",e)},expression:"searchParams.search"}})],1)],1)])])],1),i("md-card",[i("md-card-content",[i("md-table",[i("md-table-row",{staticClass:"md-head"},[i("md-table-head",[t._v("ID")]),i("md-table-head",[t._v("节点IP")]),i("md-table-head",[t._v("类型")]),i("md-table-head",[t._v("状态")]),i("md-table-head",[t._v("操作")])],1),t._l(t.clusterNodeList,(function(e,a){return i("md-table-row",{key:a},[i("md-table-cell",[t._v(t._s(e.id))]),i("md-table-cell",[t._v(t._s(e.node_ip))]),1==e.ip_type?i("md-table-cell",{staticClass:"color-blue font-bold"},[t._v(" IPV4 ")]):i("md-table-cell",{staticClass:"color-orange font-bold"},[t._v(" IPV6 ")]),1==e.node_status?i("md-table-cell",{staticClass:"color-green font-bold"},[t._v(" 健康 ")]):i("md-table-cell",{staticClass:"color-red font-bold"},[t._v(" 异常 ")]),i("md-table-cell",{staticClass:"list_manage"},[i("i",{staticClass:"iconfont icon-shanchu",on:{click:function(i){return t.deleteClusterNode(e.id)}}},[i("md-tooltip",{attrs:{"md-direction":"top"}},[t._v("删除")])],1)])],1)}))],2),t.total>0?i("Pager",{attrs:{pageSize:t.searchParams.page_size,"current-page":t.searchParams.page,totals:t.total},on:{"current-change":t.handleCurrentChange}}):t._e()],1)],1)],1)])])},re=[],le={getList:function(t){return k("admin/cluster-node/list",t)},putSwitchEnable:function(t,e){return k("admin/cluster-node/switch/enable/"+t,{is_enable:e},"put")},delete:function(t){return k("admin/cluster-node/delete/"+t,null,"delete")}},ce={components:{ListHeader:lt,Pager:it},data:function(){return{searchParams:{ip_type:"",node_status:"",search:"",page:1,page_size:10},clusterNodeList:[],total:0,sidebarBackground:"blue"}},mounted:function(){this.getList()},methods:{handleCurrentChange:function(t){this.searchParams.page=t.currentPage,this.$store.commit("currentPage",t.currentPage)},getList:function(){var t=this;le.getList(this.searchParams).then((function(e){0===e.code&&(t.total=e.data["total"],t.clusterNodeList=e.data["data"])}))},deleteClusterNode:function(t){var e=this;this.$dialog.modal({title:"提示",content:"确认要删除节点？"}).then((function(){le.delete(t).then((function(t){0===t.code?(e.$notify({message:t.msg,type:"primary"}),e.getList()):e.$notify({message:t.msg})}))}))}},watch:{searchParams:{handler:function(){this.getList()},deep:!0}}},de=ce,ue=(i("c8b8"),Object(c["a"])(de,oe,re,!1,null,"66cfe3f8",null)),me=ue.exports,fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("div",{staticClass:"md-layout"},[i("div",{staticClass:"md-layout-item md-medium-size-100 md-xsmall-size-100 md-size-100"},[i("md-card",[i("md-card-header",{attrs:{"data-background-color":"green"}},[i("h4",{staticClass:"title"},[t._v("插件管理")])]),i("md-card-content",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("搜索内容")]),i("md-input",{model:{value:t.plugInParams.search,callback:function(e){t.$set(t.plugInParams,"search",e)},expression:"plugInParams.search"}})],1)],1),i("div",{staticClass:"md-layout-item"},[i("md-button",{staticClass:"md-raised md-primary addNode",on:{click:function(e){return t.drawerPlugIn("")}}},[i("i",{staticClass:"iconfont icon-addNode"}),t._v(" 新增插件")])],1)]),i("md-table",{scopedSlots:t._u([{key:"md-table-row",fn:function(e){var a=e.item;return i("md-table-row",{},[i("md-table-cell",{attrs:{"md-label":"ID/名称"}},[t._v(t._s(a.id)),i("br"),t._v(t._s(a.name))]),i("md-table-cell",{attrs:{"md-label":"ICON"}},[t._v(t._s(a.icon))]),i("md-table-cell",{attrs:{"md-label":"TAG"}},[t._v(t._s(a.tag))]),i("md-table-cell",{attrs:{"md-label":"类型"}},[t._v(t._s(a.type_cn))]),i("md-table-cell",{attrs:{"md-label":"描述"}},[t._v(t._s(a.description))]),i("md-table-cell",{staticClass:"list_manage",attrs:{"md-label":"操作"}},[i("i",{staticClass:"iconfont icon-xiugai",on:{click:function(e){return t.drawerPlugIn(a.id)}}}),i("i",{staticClass:"iconfont icon-shanchu",on:{click:function(e){return t.deletePlugIn(a.id)}}})])],1)}}]),model:{value:t.plugInList,callback:function(e){t.plugInList=e},expression:"plugInList"}}),t.total>0?i("Pager",{attrs:{pageSize:t.plugInParams.page_size,"current-page":t.plugInParams.page,totals:t.total},on:{"current-change":t.handleCurrentChange}}):t._e()],1)],1)],1)]),i("Drawer",{attrs:{title:"新增插件",display:t.drawerDisplay,inner:!0,width:"700px"},on:{"update:display":function(e){t.drawerDisplay=e}}},[t.isShow?i("PlugInModify",{attrs:{plugInId:t.currentPlugInId},on:{closeDrawer:function(e){t.drawerDisplay=!1},saveHandle:t.saveHandle}}):t._e()],1)],1)},pe=[],ge=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("插件名称")]),i("md-input",{attrs:{required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("插件描述")]),i("md-input",{attrs:{required:""},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("插件类型")]),i("md-select",{attrs:{name:"request_methods",id:"request_methods"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.plugInTypeList,(function(e,a){return i("md-option",{key:a,attrs:{value:a}},[t._v(t._s(e))])})),1)],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("插件标识")]),i("md-input",{attrs:{required:""},model:{value:t.form.tag,callback:function(e){t.$set(t.form,"tag",e)},expression:"form.tag"}})],1)],1)]),i("div",{staticClass:"md-layout md-gutter"},[i("div",{staticClass:"md-layout-item"},[i("md-field",[i("label",[t._v("插件ICON")]),i("md-input",{attrs:{required:""},model:{value:t.form.icon,callback:function(e){t.$set(t.form,"icon",e)},expression:"form.icon"}})],1)],1)]),i("div",{staticClass:"service-button"},[i("md-button",{staticClass:"md-raised",on:{click:function(e){return t.$emit("closeDrawer")}}},[t._v("取消")]),i("md-button",{staticClass:"md-raised md-primary",on:{click:t.submitForm}},[t._v("保存")])],1)])},ve=[],he={name:"PlugInModify",props:{plugInId:{type:String,default:""}},data:function(){return{plugInTypeList:{},form:{name:"",description:"",tag:"",icon:"",type:0}}},mounted:function(){this.getInfo(),this.getPlugInType()},methods:{getInfo:function(){var t=this;0!==this.plugInId.length&&Pt.info(this.plugInId).then((function(e){if(0!==e.code)return t.$notify({message:e.msg}),t.$emit("saveHandle");for(var i=0,a=Object.keys(t.form);i<a.length;i++){var s=a[i];t.form[s]=e.data[s]}}))},getPlugInType:function(){var t=this;return Pt.typeList().then((function(e){var i={};0===e.code&&e.data.forEach((function(t,e){i[t.id]=t.name})),t.plugInTypeList=i}))},submitForm:function(){var t,e=this,i=JSON.parse(JSON.stringify(this.form));i.type=parseInt(i.type),t=this.plugInId?Pt.put(this.plugInId,i):Pt.post(i),t.then((function(t){if(0===t.code)return e.$notify({message:t.msg,type:"primary"}),e.$emit("saveHandle");e.$notify({message:t.msg})}))}}},_e=he,be=(i("4223"),Object(c["a"])(_e,ge,ve,!1,null,"5f85c1cc",null)),ye=be.exports,Ce={components:{Drawer:wt,Pager:it,PlugInModify:ye},data:function(){return{plugInParams:{is_enable:"",search:"",page:1,page_size:10},plugInList:[],plugInTypeList:{},total:0,isShow:!0,drawerDisplay:!1,currentPlugInId:""}},mounted:function(){var t=this;this.getPlugInType().then((function(){t.getList()}))},methods:{handleCurrentChange:function(t){this.plugInParams.page=t.currentPage,this.$store.commit("currentPage",t.currentPage)},saveHandle:function(){this.drawerDisplay=!1,this.getList()},getList:function(){var t=this;Pt.getList(this.plugInParams).then((function(e){0===e.code&&(t.total=e.data["total"],t.plugInList=e.data["data"],t.plugInList.forEach((function(e){e.is_enable=1===e.is_enable,e.type_cn=t.plugInTypeList[e.type]||""})))}))},getPlugInType:function(){var t=this;return Pt.typeList().then((function(e){var i={};0===e.code&&e.data.forEach((function(t,e){i[t.id]=t.name})),t.plugInTypeList=i}))},drawerPlugIn:function(t){var e=this;this.isShow=!1,this.$nextTick((function(){e.isShow=!0})),this.currentPlugInId=t,this.drawerDisplay=!0},deletePlugIn:function(t){var e=this;this.$dialog.modal({title:"提示",content:"确认要删除插件？"}).then((function(){Pt.delete(t).then((function(t){0===t.code?e.getList():e.$notify({message:t.msg})}))}))}},watch:{plugInParams:{handler:function(){this.getList()},deep:!0}}},we=Ce,ke=(i("7833"),Object(c["a"])(we,fe,pe,!1,null,"506b47b8",null)),$e=ke.exports,Pe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("notifications"),a("div",{staticClass:"md-layout login-page"},[a("div",{staticClass:"login-card"},[a("md-card",[a("div",{staticClass:"logo"},[a("div",[a("img",{staticClass:"login-logo",attrs:{src:i("bae8")}})]),a("h1",[t._v("欢迎注册APIOAK")])]),a("md-card-content",[a("md-field",{class:t.getValidationClass("name")},[a("md-icon",[t._v("face")]),a("label",[t._v("用户...")]),a("md-input",{attrs:{id:"name",required:""},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),t.$v.form.name.required?t._e():a("span",{staticClass:"md-error"},[t._v("用户不能为空")])],1),a("md-field",{class:t.getValidationClass("email")},[a("md-icon",[t._v("email")]),a("label",[t._v("邮箱...")]),a("md-input",{attrs:{id:"email",required:""},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}}),t.$v.form.email.required?t._e():a("span",{staticClass:"md-error"},[t._v("邮箱不能为空")]),t.$v.form.email.email?t._e():a("span",{staticClass:"md-error"},[t._v("邮箱格式不正确")])],1),a("md-field",{class:t.getValidationClass("password")},[a("md-icon",[t._v("lock_outline")]),a("label",[t._v("密码...")]),a("md-input",{attrs:{type:"password",id:"password",required:""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}}),t.$v.form.password.required?t._e():a("span",{staticClass:"md-error"},[t._v("密码不能为空")])],1),a("md-field",{class:t.getValidationClass("re_password")},[a("md-icon",[t._v("lock_outline")]),a("label",[t._v("确认密码...")]),a("md-input",{attrs:{type:"password",id:"re_password",required:""},model:{value:t.form.re_password,callback:function(e){t.$set(t.form,"re_password",e)},expression:"form.re_password"}}),t.$v.form.re_password.required?t._e():a("span",{staticClass:"md-error"},[t._v("确认密码不能为空")]),t.$v.form.re_password.sameAsPassword?t._e():a("span",{staticClass:"md-error"},[t._v("密码不一致")])],1),a("div",{staticClass:"login-button"},[a("md-button",{staticClass:"md-raised md-primary",on:{click:t.register}},[t._v("注册")])],1),a("div",{staticClass:"to-login"},[a("router-link",{attrs:{to:{name:"Login"}}},[t._v("已有账号，去登录 >")])],1)],1)],1)],1)])],1)},Se=[],xe={name:"Register",data:function(){return{form:{name:"",email:"",password:"",re_password:""}}},validations:{form:{name:{required:mt["required"]},email:{required:mt["required"],email:mt["email"]},password:{required:mt["required"]},re_password:{required:mt["required"],sameAsPassword:Object(mt["sameAs"])("password")}}},mounted:function(){},methods:{getValidationClass:function(t){var e=this.$v.form[t];if(e)return{"md-invalid":e.$invalid&&e.$dirty}},register:function(){var t=this;this.$v.$touch(),this.$v.$invalid||I.register(this.form).then((function(e){0===e.code?(t.$notify({message:"注册成功，请登录",type:"success"}),t.$router.push({name:"Login"})):t.$notify({message:e.msg})}))}}},Ie=xe,Le=(i("d221"),Object(c["a"])(Ie,Pe,Se,!1,null,"ea465270",null)),Te=Le.exports,Re=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("notifications"),a("div",{staticClass:"md-layout login-page"},[a("div",{staticClass:"login-card"},[a("md-card",[a("div",{staticClass:"logo"},[a("div",[a("img",{staticClass:"login-logo",attrs:{src:i("bae8")}})]),a("h1",[t._v("欢迎登录APIOAK")])]),a("md-card-content",[a("md-field",{class:t.getValidationClass("email")},[a("md-icon",[t._v("email")]),a("label",[t._v("邮箱...")]),a("md-input",{attrs:{required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login.apply(null,arguments)}},model:{value:t.email,callback:function(e){t.email="string"===typeof e?e.trim():e},expression:"email"}}),t.$v.email.required?t._e():a("span",{staticClass:"md-error"},[t._v("邮箱不能为空")]),t.$v.email.email?t._e():a("span",{staticClass:"md-error"},[t._v("邮箱格式不正确")])],1),a("md-field",{class:t.getValidationClass("password")},[a("md-icon",[t._v("lock_outline")]),a("label",[t._v("密码...")]),a("md-input",{attrs:{type:"password",required:""},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login.apply(null,arguments)}},model:{value:t.password,callback:function(e){t.password="string"===typeof e?e.trim():e},expression:"password"}}),t.$v.password.required?t._e():a("span",{staticClass:"md-error"},[t._v("密码不能为空")])],1),a("div",{staticClass:"login-button"},[a("md-button",{staticClass:"md-raised md-primary",on:{click:t.login}},[t._v(" 登录 ")])],1),a("div",{staticClass:"to-login"},[a("router-link",{attrs:{to:{name:"Register"}}},[t._v("暂无账号，去注册 >")])],1)],1)],1)],1)])],1)},Ne=[],Oe={name:"Login",data:function(){return{email:"",password:""}},validations:{email:{required:mt["required"],email:mt["email"]},password:{required:mt["required"]}},mounted:function(){},methods:{getValidationClass:function(t){var e=this.$v[t];if(e)return{"md-invalid":e.$invalid&&e.$dirty}},login:function(){var t=this;this.$v.$touch(),this.$v.$invalid||I.login(this.email,this.password).then((function(e){0===e.code?(t.$store.commit("setToken",e.data["token"]),t.$router.push({name:"Services"})):t.$notify({message:e.msg})}))}}},De=Oe,je=(i("9102"),Object(c["a"])(De,Re,Ne,!1,null,"3f39fe66",null)),Ee=je.exports,qe=[{path:"/login",name:"Login",component:Ee},{path:"/register",name:"Register",component:Te},{path:"/",component:G,redirect:"services",children:[{path:"services",name:"Services",component:Ot},{path:"router",name:"Router",component:Ut},{path:"certificate",name:"Certificate",component:ne},{path:"cluster-node",name:"ClusterNode",component:me},{path:"plugin",name:"Plugin",component:$e}]}],ze=qe,Ae=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.closeDropDown,expression:"closeDropDown"}],staticClass:"dropdown",class:{open:t.isOpen},on:{click:t.toggleDropDown}},[t._t("title",(function(){return[i("a",{staticClass:"dropdown-toggle",attrs:{"data-toggle":"dropdown",href:"javascript:void(0)"}},[i("i",{class:t.icon}),i("p",{staticClass:"notification"},[t._v(" "+t._s(t.title)+" "),i("b",{staticClass:"caret"})])])]})),t._t("default")],2)},He=[],Me={name:"drop-down",props:{title:String,icon:String},data:function(){return{isOpen:!1}},methods:{toggleDropDown:function(){this.isOpen=!this.isOpen},closeDropDown:function(){this.isOpen=!1}}},Be=Me,Ve=Object(c["a"])(Be,Ae,He,!1,null,null,null),Je=Ve.exports,Fe={install:function(t){t.component("drop-down",Je)}},Ue=Fe,Ke=i("a3cf"),Ge={install:function(t){t.directive("click-outside",Ke["directive"])}},Xe=Ge,Ye=(i("4f11"),i("f3f1"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"notifications"},[i("transition-group",{attrs:{name:"list"}},t._l(t.notifications,(function(e){return i("notification",{key:e.timestamp.getTime(),attrs:{message:e.message,icon:e.icon,type:e.type,timestamp:e.timestamp,"vertical-align":e.verticalAlign,"horizontal-align":e.horizontalAlign},on:{"on-close":t.removeNotification}})})),1)],1)}),Qe=[],We=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"alert open alert-with-icon",class:[t.verticalAlign,t.horizontalAlign,t.alertType],style:t.customPosition,attrs:{"data-notify":"container",role:"alert","data-notify-position":"top-center"},on:{click:function(e){return t.close()}}},[i("button",{staticClass:"close",attrs:{type:"button","aria-hidden":"true","data-notify":"dismiss"},on:{click:t.close}},[t._v(" × ")]),i("i",{staticClass:"material-icons",attrs:{"data-notify":"icon"}},[t._v(t._s(t.icon))]),i("span",{attrs:{"data-notify":"message"},domProps:{innerHTML:t._s(t.message)}})])},Ze=[],ti={name:"notification",props:{message:String,icon:String,verticalAlign:{type:String,default:"top"},horizontalAlign:{type:String,default:"center"},type:{type:String,default:"info"},timeout:{type:Number,default:2500},timestamp:{type:Date,default:function(){return new Date}}},data:function(){return{elmHeight:0}},computed:{hasIcon:function(){return this.icon&&this.icon.length>0},alertType:function(){return"alert-".concat(this.type)},customPosition:function(){var t=this,e=20,i=this.elmHeight+10,a=this.$notifications.state.filter((function(e){return e.horizontalAlign===t.horizontalAlign&&e.verticalAlign===t.verticalAlign&&e.timestamp<=t.timestamp})).length,s=(a-1)*i+e,n={};return"top"===this.verticalAlign?n.top="".concat(s,"px"):n.bottom="".concat(s,"px"),n}},methods:{close:function(){this.$emit("on-close",this.timestamp)}},mounted:function(){this.elmHeight=this.$el.clientHeight,this.timeout&&setTimeout(this.close,this.timeout)}},ei=ti,ii=(i("4de5"),Object(c["a"])(ei,We,Ze,!1,null,"240896ec",null)),ai=ii.exports,si={components:{Notification:ai},data:function(){return{notifications:this.$notifications.state}},methods:{removeNotification:function(t){this.$notifications.removeNotification(t)}}},ni=si,oi=(i("6ae5"),Object(c["a"])(ni,Ye,Qe,!1,null,null,null)),ri=oi.exports,li={state:[],initParams:{icon:"add_alert",horizontalAlign:"center",verticalAlign:"top",type:"danger"},removeNotification:function(t){var e=this.state.findIndex((function(e){return e.timestamp===t}));-1!==e&&this.state.splice(e,1)},addNotification:function(t){t.timestamp=new Date,t.timestamp.setMilliseconds(t.timestamp.getMilliseconds()+this.state.length),this.state.push(t)},notify:function(t){var e=this,i={};Array.isArray(t)?t.forEach((function(t){e.addNotification(t)})):(Object.assign(i,this.initParams,t),this.addNotification(i))}},ci={install:function(t){t.mixin({data:function(){return{notificationStore:li}},methods:{notify:function(t){this.notificationStore.notify(t)}}}),Object.defineProperty(t.prototype,"$notify",{get:function(){return this.$root.notify}}),Object.defineProperty(t.prototype,"$notifications",{get:function(){return this.$root.notificationStore}}),t.component("Notifications",ri)}},di=ci,ui=i("6fc5"),mi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("md-dialog-confirm",{attrs:{"md-active":t.isShowMessageBox,"md-title":t.title,"md-content":t.content,"md-confirm-text":"同意","md-cancel-text":"取消"},on:{"update:mdActive":function(e){t.isShowMessageBox=e},"update:md-active":function(e){t.isShowMessageBox=e},"md-cancel":t.cancel,"md-confirm":t.confirm}})],1)},fi=[],pi={data:function(){return{title:"",content:"",isShowMessageBox:!1,resolve:"",reject:"",promise:""}},methods:{close:function(t){this.model.show=!1,this.model.callback&&this.model.callback(t)},confirm:function(){this.isShowMessageBox=!1,this.isShowInput?this.resolve(this.inputValue):this.resolve("confirm"),this.remove()},cancel:function(){this.isShowMessageBox=!1,this.reject("cancel"),this.remove()},modal:function(){var t=this;return this.isShowMessageBox=!0,this.promise=new Promise((function(e,i){t.resolve=e,t.reject=i})),this.promise},remove:function(){var t=this;setTimeout((function(){t.destroy()}),300)},destroy:function(){this.$destroy(),document.body.removeChild(this.$el)}}},gi=pi,vi=Object(c["a"])(gi,mi,fi,!1,null,null,null),hi=vi.exports,_i={install:function(t,e){var i,a=t.extend(hi),s=function(){i=new a;var t=i.$mount().$el;document.body.appendChild(t)};t.prototype.$dialog={modal:function(t){return i||s(),"string"===typeof t?i.content=t:"object"===Object(ui["a"])(t)&&Object.assign(i,t),i.modal().then((function(t){return i=null,Promise.resolve(t)})).catch((function(t){return i=null,Promise.reject(t)}))}}}},bi=_i,yi=i("43ef"),Ci=i.n(yi),wi=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sidebar",style:t.sidebarStyle,attrs:{"data-color":t.sidebarItemColor,"data-image":t.sidebarBackgroundImage}},[i("div",{staticClass:"logo"},[i("a",{staticClass:"simple-text logo-mini",attrs:{href:""}},[i("div",{staticClass:"logo-img"},[i("img",{attrs:{src:t.imgLogo,alt:""}})])]),i("a",{staticClass:"simple-text logo-normal",attrs:{href:""}},[t._v(" "+t._s(t.title)+" ")])]),i("div",{staticClass:"sidebar-wrapper"},[t._t("content"),i("md-list",{staticClass:"nav"},[t._t("default",(function(){return t._l(t.sidebarLinks,(function(t,e){return i("sidebar-link",{key:t.name+e,attrs:{to:t.path,link:t}})}))}))],2)],2)])},ki=[],$i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"md-list-item"},[i("router-link",t._b({staticClass:"md-list-item-router md-list-item-container md-button-clean",on:{click:t.hideSidebar}},"router-link",t.$attrs,!1),[i("div",{staticClass:"md-list-item-content md-ripple"},[t._t("default",(function(){return[i("md-icon",[t._v(t._s(t.link.icon))]),i("p",[t._v(t._s(t.link.name))])]}))],2)])],1)},Pi=[],Si={inject:{autoClose:{default:!0}},props:{link:{type:[String,Object],default:function(){return{name:"",path:"",icon:""}}},tag:{type:String,default:"router-link"}},methods:{hideSidebar:function(){this.autoClose&&this.$sidebar&&!0===this.$sidebar.showSidebar&&this.$sidebar.displaySidebar(!1)}}},xi=Si,Ii=Object(c["a"])(xi,$i,Pi,!1,null,null,null),Li=Ii.exports,Ti={components:{SidebarLink:Li},props:{title:{type:String,default:"APIOAK"},sidebarBackgroundImage:{type:String,default:i("9524")},imgLogo:{type:String,default:i("bae8")},sidebarItemColor:{type:String,default:"blue",validator:function(t){var e=["blue","green","orange","red","purple"];return-1!==e.indexOf(t)}},sidebarLinks:{type:Array,default:function(){return[]}},autoClose:{type:Boolean,default:!0}},provide:function(){return{autoClose:this.autoClose}},computed:{sidebarStyle:function(){return{backgroundColor:"#01579b"}}}},Ri=Ti,Ni=(i("0efd"),Object(c["a"])(Ri,wi,ki,!1,null,null,null)),Oi=Ni.exports,Di={showSidebar:!1,displaySidebar:function(t){this.showSidebar=t}},ji={install:function(t){t.mixin({data:function(){return{sidebarStore:Di}}}),Object.defineProperty(t.prototype,"$sidebar",{get:function(){return this.$root.sidebarStore}}),t.component("side-bar",Oi),t.component("sidebar-link",Li)}},Ei=ji,qi=i("25e5"),zi=i.n(qi),Ai=(i("19d3"),i("9e17"),i("470c"),{install:function(t){t.use(Ei),t.use(zi.a)}}),Hi=i("c99d"),Mi=i.n(Hi);Object.keys(g.a).forEach((function(t){return a["default"].filter(t,g.a[t])}));var Bi=new s["a"]({routes:ze,linkExactActiveClass:"nav-item active"});a["default"].prototype.$Chartist=Mi.a,a["default"].use(s["a"]),a["default"].use(Ai),a["default"].use(Ue),a["default"].use(Xe),a["default"].use(di),a["default"].use(bi),a["default"].use(Ci.a),new a["default"]({el:"#app",render:function(t){return t(u)},router:Bi,store:f,data:{Chartist:Mi.a}})},5985:function(t,e,i){"use strict";i("d8b2")},6061:function(t,e,i){},"6ae5":function(t,e,i){"use strict";i("a404")},"6d19":function(t,e,i){},7833:function(t,e,i){"use strict";i("555f")},"7b30":function(t,e,i){},"80d7":function(t,e,i){},"813d":function(t,e,i){"use strict";i("effa")},8975:function(t,e,i){function a(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var a in i)if(new RegExp("(".concat(a,")")).test(e)){var n=i[a]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?n:s(n))}return e}function s(t){return("00"+t).substr(t.length)}i("bd79"),i("9a8c"),i("3d3a"),i("f926"),i("401f"),i("d84a"),i("d702"),e.protocolName=function(t){var e="";switch(t){case 1:e="HTTP";break;case 2:e="HTTPS";break;case 3:e="HTTP&HTTPS";break}return e},e.loadBalanceName=function(t){var e="";switch(t){case 1:e="加权轮询";break;case 2:e="ip_hash";break}return e},e.formatTime=function(t){var e=new Date(1e3*t);return a(e,"yyyy-MM-dd hh:mm:ss")}},"89b6":function(t,e,i){"use strict";i("0190")},9102:function(t,e,i){"use strict";i("80d7")},9524:function(t,e,i){t.exports=i.p+"img/sidebar-2.32103624.jpg"},9881:function(t,e,i){"use strict";i("a815")},"9dfa":function(t,e,i){},"9e17":function(t,e,i){},a342:function(t,e,i){},a404:function(t,e,i){},a815:function(t,e,i){},bae8:function(t,e,i){t.exports=i.p+"img/apioak-logo.c5037b3b.png"},c1ce:function(t,e,i){"use strict";i("6d19")},c2b1:function(t,e,i){},c8b8:function(t,e,i){"use strict";i("d42a")},d221:function(t,e,i){"use strict";i("6061")},d42a:function(t,e,i){},d469:function(t,e,i){},d716:function(t,e,i){},d8b2:function(t,e,i){},db41:function(t,e,i){},e636:function(t,e,i){},e9cc:function(t,e,i){"use strict";i("9dfa")},ede3:function(t,e,i){"use strict";i("39bf")},effa:function(t,e,i){},ff96:function(t,e,i){}});